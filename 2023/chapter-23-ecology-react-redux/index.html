<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>ç¬¬23ç« â€”ç”Ÿæ€ç¯‡-React-redux | æ˜é‡‘å°å†Œ</title><link rel="stylesheet" type="text/css" href="/book/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/book/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/book/favicon.ico"><link rel="apple-touch-icon" href="/book/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/book/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/book/atom.xml"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ç¬¬23ç« â€”ç”Ÿæ€ç¯‡-React-redux</h1><a id="logo" href="/book/.">æ˜é‡‘å°å†Œ</a><p class="description">å­¦æµ·æ— æ¶¯ï¼Œå…±åŒè¿›æ­¥ï¼</p></div><div id="nav-menu"><a class="current" href="/book/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/book/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/book/about/"><i class="fa fa-user"> å…³äº</i></a><a href="/book/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a><a href="/book/guestbook/"><i class="fa fa-comments"> ç•™è¨€</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">ç¬¬23ç« â€”ç”Ÿæ€ç¯‡-React-redux</h1><div class="post-meta">2023-09-26<span> | </span><span class="category"><a href="/book/categories/%E9%BB%98%E8%AE%A4/">é»˜è®¤</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 5.2k</span><span class="post-meta-item-text"> å­—</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 21</span><span class="post-meta-item-text"> åˆ†é’Ÿ</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">æ–‡ç« ç›®å½•</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%89%8D%E8%A8%80"><span class="toc-text">ä¸€ å‰è¨€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">1 çŠ¶æ€ç®¡ç†åº”ç”¨åœºæ™¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-React-Redux-Redux-React%E4%B8%89%E8%80%85%E5%85%B3%E7%B3%BB"><span class="toc-text">2 React-Redux,Redux,Reactä¸‰è€…å…³ç³»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B8%A9%E4%B9%A0-Redux"><span class="toc-text">3 æ¸©ä¹  Redux</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A0%E4%B8%89%E5%A4%A7%E5%8E%9F%E5%88%99"><span class="toc-text">â‘ ä¸‰å¤§åŸåˆ™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A1%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%80%9D%E6%83%B3"><span class="toc-text">â‘¡å‘å¸ƒè®¢é˜…æ€æƒ³</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A2%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%80%9D%E6%83%B3"><span class="toc-text">â‘¢ä¸­é—´ä»¶æ€æƒ³</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A3%E6%A0%B8%E5%BF%83api"><span class="toc-text">â‘£æ ¸å¿ƒapi</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%91%A4-%E5%AE%9E%E6%88%98-redux%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-text">â‘¤ å®æˆ˜-reduxåŸºæœ¬ç”¨æ³•</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-React-Redux%E7%94%A8%E6%B3%95"><span class="toc-text">äºŒ React-Reduxç”¨æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%94%A8%E6%B3%95%E7%AE%80%E4%BB%8B"><span class="toc-text">1 ç”¨æ³•ç®€ä»‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Provider"><span class="toc-text">Provider</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#connect"><span class="toc-text">connect</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%9E%E8%B7%B5%E4%B8%80%EF%BC%9AReact-Redux%E5%AE%9E%E7%8E%B0%E7%8A%B6%E6%80%81%E5%85%B1%E4%BA%AB"><span class="toc-text">2 å®è·µä¸€ï¼šReact-Reduxå®ç°çŠ¶æ€å…±äº«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%9E%E8%B7%B5%E4%BA%8C%EF%BC%9AReact-Redux%E5%AE%9E%E7%8E%B0%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-text">3 å®è·µäºŒï¼šReact-Reduxå®ç°ç»„ä»¶é€šä¿¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-React-Redux%E5%8E%9F%E7%90%86"><span class="toc-text">ä¸‰ React-ReduxåŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9A-Provider%E6%B3%A8%E5%85%A5Store"><span class="toc-text">ç¬¬ä¸€éƒ¨åˆ†ï¼š Provideræ³¨å…¥Store</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%EF%BC%9A-Subscription%E8%AE%A2%E9%98%85%E5%99%A8"><span class="toc-text">ç¬¬äºŒéƒ¨åˆ†ï¼š Subscriptionè®¢é˜…å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%EF%BC%9A-connect%E6%8E%A7%E5%88%B6%E6%9B%B4%E6%96%B0"><span class="toc-text">ç¬¬ä¸‰éƒ¨åˆ†ï¼š connectæ§åˆ¶æ›´æ–°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E5%AE%9E%E7%8E%B0%E5%BC%82%E6%AD%A5"><span class="toc-text">å›› å®ç°å¼‚æ­¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E6%80%BB%E7%BB%93"><span class="toc-text">äº” æ€»ç»“</span></a></li></ol></div></div><div class="post-content"><h2 id="ä¸€-å‰è¨€"><a href="#ä¸€-å‰è¨€" class="headerlink" title="ä¸€ å‰è¨€"></a>ä¸€ å‰è¨€</h2><p>çŠ¶æ€ç®¡ç†æ˜¯å•é¡µé¢åº”ç”¨è§£å†³ç»„ä»¶çŠ¶æ€å…±äº«ï¼Œå¤æ‚ç»„ä»¶é€šä¿¡çš„æŠ€æœ¯æ–¹æ¡ˆã€‚æ¥ä¸‹æ¥çš„ä¸¤ä¸ªç« èŠ‚ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç» React åº”ç”¨ä¸­å¸¸è§çš„ä¸¤ç§çŠ¶æ€ç®¡ç†æ–¹å¼- <strong>React-Redux</strong> å’Œ <strong>React-Mobx</strong> ã€‚</p>
<p>æœ¬ç« èŠ‚ä¸»è¦è®² React-Reduxï¼ŒåŒ…æ‹¬Redux è®¾è®¡æ€æƒ³ã€ä¸­é—´ä»¶åŸç†ï¼Œä»¥åŠ React-Redux çš„ç”¨æ³•å’ŒåŸç†ã€‚</p>
<h3 id="1-çŠ¶æ€ç®¡ç†åº”ç”¨åœºæ™¯"><a href="#1-çŠ¶æ€ç®¡ç†åº”ç”¨åœºæ™¯" class="headerlink" title="1 çŠ¶æ€ç®¡ç†åº”ç”¨åœºæ™¯"></a>1 çŠ¶æ€ç®¡ç†åº”ç”¨åœºæ™¯</h3><p>çŠ¶æ€ç®¡ç†å·¥å…·ä¸ºä»€ä¹ˆå—åˆ°å¼€å‘è€…çš„æ¬¢è¿å‘¢ï¼Ÿæˆ‘è®¤ä¸ºé¦–å…ˆåº”è¯¥æƒ³æƒ³çŠ¶æ€ç®¡ç†é€‚ç”¨äºä»€ä¹ˆåœºæ™¯ã€‚è§£å†³äº†ä»€ä¹ˆé—®é¢˜ã€‚</p>
<p><strong>â‘  ç»„ä»¶ä¹‹é—´å…±ç”¨æ•°æ®ï¼Œå¦‚ä½•å¤„ç†?</strong></p>
<p>è®¾æƒ³ä¸€ç§åœºæ™¯ï¼Œå°±æ˜¯ä¸€äº›é€šè¿‡ ajax å‘æœåŠ¡å™¨è¯·æ±‚çš„é‡è¦æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·ä¿¡æ¯ï¼Œæƒé™åˆ—è¡¨ï¼Œå¯èƒ½ä¼šè¢«å¤šä¸ªç»„ä»¶éœ€è¦ï¼Œé‚£ä¹ˆå¦‚æœæ¯ä¸ªç»„ä»¶åˆå§‹åŒ–éƒ½è¯·æ±‚ä¸€éæ•°æ®æ˜¾ç„¶æ˜¯ä¸åˆç†çš„ã€‚è¿™æ—¶å€™å¸¸ç”¨çš„ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œåº”ç”¨åˆå§‹åŒ–æ—¶å€™ï¼Œåªè¯·æ±‚ä¸€æ¬¡æ•°æ®ï¼Œç„¶åé€šè¿‡çŠ¶æ€ç®¡ç†æŠŠæ•°æ®å­˜èµ·æ¥ï¼Œéœ€è¦æ•°æ®çš„ç»„ä»¶åªéœ€è¦ä»çŠ¶æ€ç®¡ç†ä¸­â€˜æ‹¿â€™å°±å¯ä»¥äº†ã€‚</p>
<p>æ•ˆæœå›¾ï¼š</p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261717699.jpeg" alt="3.jpg"></p>
<p><strong>â‘¡ å¤æ‚ç»„ä»¶ä¹‹é—´å¦‚ä½•é€šä¿¡ï¼Ÿ</strong></p>
<p>è¿˜æœ‰ä¸€ç§åœºæ™¯å°±æ˜¯å¯¹äº spa å•é¡µé¢åº”ç”¨ä¸€åˆ‡çš†ç»„ä»¶ï¼Œå¯¹äºåµŒå¥—æ¯”è¾ƒæ·±çš„ç»„ä»¶ï¼Œç»„ä»¶é€šä¿¡æˆäº†ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ã€‚æ¯”å¦‚å¦‚ä¸‹çš„åœºæ™¯ï¼Œ B ç»„ä»¶å‘ H ç»„ä»¶ä¼ é€’æŸäº›ä¿¡æ¯ï¼Œé‚£ä¹ˆå¸¸è§„çš„é€šä¿¡æ–¹å¼ä¼¼ä¹éš¾ä»¥å®ç°ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™çŠ¶æ€ç®¡ç†å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œå¯ä»¥æŠŠ B ç»„ä»¶çš„ä¿¡æ¯ä¼ é€’ç»™çŠ¶æ€ç®¡ç†å±‚ï¼ŒH ç»„ä»¶è¿æ¥çŠ¶æ€ç®¡ç†å±‚ï¼Œå†ç”±çŠ¶æ€ç®¡ç†å±‚é€šçŸ¥ H ç»„ä»¶ï¼Œè¿™æ ·å°±æœ¬è´¨è§£å†³äº†ç»„ä»¶é€šä¿¡é—®é¢˜ã€‚</p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261717780.jpeg" alt="4.jpg"></p>
<h3 id="2-React-Redux-Redux-Reactä¸‰è€…å…³ç³»"><a href="#2-React-Redux-Redux-Reactä¸‰è€…å…³ç³»" class="headerlink" title="2 React-Redux,Redux,Reactä¸‰è€…å…³ç³»"></a>2 React-Redux,Redux,Reactä¸‰è€…å…³ç³»</h3><p>åœ¨æ·±å…¥ç ”ç©¶ React-Redux ä¹‹å‰ï¼Œåº”è¯¥å…ˆå¼„æ˜ç™½ React-Redux ï¼ŒRedux ï¼Œ React ä¸‰è€…åˆ°åº•æ˜¯ä»€ä¹ˆå…³ç³»ã€‚</p>
<ul>
<li><p><code>Redux</code>ï¼š é¦–å…ˆ Redux æ˜¯ä¸€ä¸ªåº”ç”¨çŠ¶æ€ç®¡ç†jsåº“ï¼Œå®ƒæœ¬èº«å’Œ React æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œæ¢å¥è¯è¯´ï¼ŒRedux å¯ä»¥åº”ç”¨äºå…¶ä»–æ¡†æ¶æ„å»ºçš„å‰ç«¯åº”ç”¨ï¼Œç”šè‡³ä¹Ÿå¯ä»¥åº”ç”¨äº Vue ä¸­ã€‚</p>
</li>
<li><p><code>React-Redux</code>ï¼šReact-Redux æ˜¯è¿æ¥ React åº”ç”¨å’Œ Redux çŠ¶æ€ç®¡ç†çš„æ¡¥æ¢ã€‚React-redux ä¸»è¦ä¸“æ³¨ä¸¤ä»¶äº‹ï¼Œä¸€æ˜¯å¦‚ä½•å‘ React åº”ç”¨ä¸­æ³¨å…¥ redux ä¸­çš„ Store ï¼ŒäºŒæ˜¯å¦‚ä½•æ ¹æ® Store çš„æ”¹å˜ï¼ŒæŠŠæ¶ˆæ¯æ´¾å‘ç»™åº”ç”¨ä¸­éœ€è¦çŠ¶æ€çš„æ¯ä¸€ä¸ªç»„ä»¶ã€‚</p>
</li>
<li><p><code>React</code>ï¼šè¿™ä¸ªå°±ä¸å¿…å¤šè¯´äº†ã€‚</p>
</li>
</ul>
<p>ä¸‰è€…çš„å…³ç³»å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261717741.jpeg" alt="3.jpg"></p>
<h3 id="3-æ¸©ä¹ -Redux"><a href="#3-æ¸©ä¹ -Redux" class="headerlink" title="3 æ¸©ä¹  Redux"></a>3 æ¸©ä¹  Redux</h3><p>å½»åº•å¼„æ˜ç™½ React-Redux ä¹‹å‰ï¼Œå°±å¿…é¡»è¦ææ‡‚ Redux åœ¨ React ä¸­æ‰®æ¼”çš„è§’è‰²ã€‚Redux çš„è®¾è®¡æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªåŸåˆ™ï¼š</p>
<h4 id="â‘ ä¸‰å¤§åŸåˆ™"><a href="#â‘ ä¸‰å¤§åŸåˆ™" class="headerlink" title="â‘ ä¸‰å¤§åŸåˆ™"></a>â‘ ä¸‰å¤§åŸåˆ™</h4><ul>
<li>1 å•å‘æ•°æ®æµï¼šæ•´ä¸ª redux ï¼Œæ•°æ®æµå‘éƒ½æ˜¯å•å‘çš„ï¼Œæˆ‘ç”¨ä¸€å¼ å®˜ç½‘çš„å›¾ç‰‡æè¿°æ•´ä¸ªæ•°æ®æµåŠ¨çš„æµç¨‹ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261717613.gif" alt="redux.gif"></p>
<ul>
<li><p>2 state åªè¯»ï¼šåœ¨ Redux ä¸­ä¸èƒ½é€šè¿‡ç›´æ¥æ”¹å˜ state ï¼Œæ¥è®©çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœæƒ³è¦æ”¹å˜ state ï¼Œé‚£å°±å¿…é¡»è§¦å‘ä¸€æ¬¡ action ï¼Œé€šè¿‡ action æ‰§è¡Œæ¯ä¸ª reducer ã€‚ </p>
</li>
<li><p>3 çº¯å‡½æ•°æ‰§è¡Œï¼šæ¯ä¸€ä¸ª reducer éƒ½æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œé‡Œé¢ä¸è¦æ‰§è¡Œä»»ä½•å‰¯ä½œç”¨ï¼Œè¿”å›çš„å€¼ä½œä¸ºæ–°çš„ state ï¼Œstate æ”¹å˜ä¼šè§¦å‘ store ä¸­çš„ subscribe ã€‚</p>
</li>
</ul>
<h4 id="â‘¡å‘å¸ƒè®¢é˜…æ€æƒ³"><a href="#â‘¡å‘å¸ƒè®¢é˜…æ€æƒ³" class="headerlink" title="â‘¡å‘å¸ƒè®¢é˜…æ€æƒ³"></a>â‘¡å‘å¸ƒè®¢é˜…æ€æƒ³</h4><p>redux å¯ä»¥ä½œä¸ºå‘å¸ƒè®¢é˜…æ¨¡å¼çš„ä¸€ä¸ªå…·ä½“å®ç°ã€‚redux éƒ½ä¼šåˆ›å»ºä¸€ä¸ª store ï¼Œé‡Œé¢ä¿å­˜äº†çŠ¶æ€ä¿¡æ¯ï¼Œæ”¹å˜ store çš„æ–¹æ³• dispatch ï¼Œä»¥åŠè®¢é˜… store å˜åŒ–çš„æ–¹æ³• subscribe ã€‚</p>
<h4 id="â‘¢ä¸­é—´ä»¶æ€æƒ³"><a href="#â‘¢ä¸­é—´ä»¶æ€æƒ³" class="headerlink" title="â‘¢ä¸­é—´ä»¶æ€æƒ³"></a>â‘¢ä¸­é—´ä»¶æ€æƒ³</h4><p>redux åº”ç”¨äº†å‰ç«¯é¢†åŸŸä¸ºæ•°ä¸å¤šçš„ä¸­é—´ä»¶ <code>compose</code> ï¼Œé‚£ä¹ˆ redux çš„ä¸­é—´ä»¶æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿ ç­”æ¡ˆåªæœ‰ä¸€ä¸ªï¼š é‚£å°±æ˜¯<strong>å¼ºåŒ– dispatch</strong> ï¼Œ Redux æä¾›äº†ä¸­é—´ä»¶æœºåˆ¶ï¼Œä½¿ç”¨è€…å¯ä»¥æ ¹æ®éœ€è¦æ¥å¼ºåŒ– dispatch å‡½æ•°ï¼Œä¼ ç»Ÿçš„ dispatch æ˜¯ä¸æ”¯æŒå¼‚æ­¥çš„ï¼Œä½†æ˜¯å¯ä»¥é’ˆå¯¹ Redux åšå¼ºåŒ–ï¼Œäºæ˜¯æœ‰äº† <code>redux-thunk</code>ï¼Œ<code>redux-actions</code> ç­‰ä¸­é—´ä»¶ï¼ŒåŒ…æ‹¬ dvajs ä¸­ï¼Œä¹Ÿå†™äº†ä¸€ä¸ª redux æ”¯æŒ promise çš„ä¸­é—´ä»¶ã€‚</p>
<p>ä¸€èµ·æ¥çœ‹ä¸€ä¸‹ compose æ˜¯å¦‚ä½•å®ç°çš„ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">compose</span> = (<span class="params">...funcs</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> funcs.<span class="title function_">reduce</span>(<span class="function">(<span class="params">f, g</span>) =&gt;</span> <span class="function">(<span class="params">x</span>) =&gt;</span> <span class="title function_">f</span>(<span class="title function_">g</span>(x)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>funcs ä¸ºä¸­é—´ä»¶ç»„æˆçš„æ•°ç»„ï¼Œcompose é€šè¿‡æ•°ç»„çš„ reduce æ–¹æ³•ï¼Œå®ç°æ‰§è¡Œæ¯ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå¼ºåŒ– dispatch ã€‚</li>
</ul>
<h4 id="â‘£æ ¸å¿ƒapi"><a href="#â‘£æ ¸å¿ƒapi" class="headerlink" title="â‘£æ ¸å¿ƒapi"></a>â‘£æ ¸å¿ƒapi</h4><p>å¯¹äºå†…éƒ¨åŸç†ï¼Œæˆ‘è¿™é‡Œå°±ä¸å¤šè¯´äº†ï¼Œæ¯•ç«Ÿè¿™èŠ‚ä¸»è¦è®²çš„æ˜¯ React-Redux ï¼Œä¸»è¦å…ˆæ¥çœ‹ä¸€ä¸‹ redux å‡ ä¸ªæ¯”è¾ƒæ ¸å¿ƒçš„ api:</p>
<p><strong>createStore</strong></p>
<p><code>createStore</code> reduxä¸­é€šè¿‡ createStore å¯ä»¥åˆ›å»ºä¸€ä¸ª Store ï¼Œä½¿ç”¨è€…å¯ä»¥å°†è¿™ä¸ª Store ä¿å­˜ä¼ é€’ç»™ React åº”ç”¨ï¼Œå…·ä½“æ€ä¹ˆä¼ é€’é‚£å°±æ˜¯ React-Redux åšçš„äº‹äº†ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹ createStore çš„ä½¿ç”¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Store</span> = <span class="title function_">createStore</span>(rootReducer,initialState,middleware)</span><br></pre></td></tr></table></figure>
<ul>
<li>å‚æ•°ä¸€ reducers ï¼š redux çš„ reducer ï¼Œå¦‚æœæœ‰å¤šä¸ªé‚£ä¹ˆå¯ä»¥è°ƒç”¨ combineReducers åˆå¹¶ã€‚</li>
<li>å‚æ•°äºŒ initialState ï¼šåˆå§‹åŒ–çš„ state ã€‚</li>
<li>å‚æ•°ä¸‰ middleware ï¼šå¦‚æœæœ‰ä¸­é—´ä»¶ï¼Œé‚£ä¹ˆå­˜æ”¾ redux ä¸­é—´ä»¶ã€‚</li>
</ul>
<p><strong>combineReducers</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å°† number å’Œ PersonalInfo ä¸¤ä¸ªreduceråˆå¹¶   */</span></span><br><span class="line"><span class="keyword">const</span> rootReducer = <span class="title function_">combineReducers</span>(&#123; <span class="attr">number</span>:numberReducer,<span class="attr">info</span>:<span class="title class_">InfoReducer</span> &#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>æ­£å¸¸çŠ¶æ€å¯ä»¥ä¼šæœ‰å¤šä¸ª reducer ï¼ŒcombineReducers å¯ä»¥åˆå¹¶å¤šä¸ªreducerã€‚</li>
</ul>
<p><strong>applyMiddleware</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> middleware = <span class="title function_">applyMiddleware</span>(logMiddleware)</span><br></pre></td></tr></table></figure>
<ul>
<li>applyMiddleware ç”¨äºæ³¨å†Œä¸­é—´ä»¶ï¼Œæ”¯æŒå¤šä¸ªå‚æ•°ï¼Œæ¯ä¸€ä¸ªå‚æ•°éƒ½æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ã€‚æ¯æ¬¡è§¦å‘ action ï¼Œä¸­é—´ä»¶ä¾æ¬¡æ‰§è¡Œã€‚</li>
</ul>
<h4 id="â‘¤-å®æˆ˜-reduxåŸºæœ¬ç”¨æ³•"><a href="#â‘¤-å®æˆ˜-reduxåŸºæœ¬ç”¨æ³•" class="headerlink" title="â‘¤ å®æˆ˜-reduxåŸºæœ¬ç”¨æ³•"></a>â‘¤ å®æˆ˜-reduxåŸºæœ¬ç”¨æ³•</h4><p><strong>ç¬¬ä¸€æ­¥ï¼šç¼–å†™reducer</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* number Reducer */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">numberReducer</span>(<span class="params">state=<span class="number">1</span>,action</span>)&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> state + <span class="number">1</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DEL&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> state - <span class="number">1</span></span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* ç”¨æˆ·ä¿¡æ¯reducer */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">InfoReducer</span>(<span class="params">state=&#123;&#125;,action</span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; payload = &#123;&#125; &#125; = action</span><br><span class="line">   <span class="keyword">switch</span> (action.<span class="property">type</span>)&#123;</span><br><span class="line">     <span class="keyword">case</span> <span class="string">&#x27;SET&#x27;</span>:</span><br><span class="line">       <span class="keyword">return</span> &#123;</span><br><span class="line">         ...state,</span><br><span class="line">         ...payload</span><br><span class="line">       &#125;</span><br><span class="line">     <span class="attr">default</span>:</span><br><span class="line">       <span class="keyword">return</span> state</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ç¼–å†™äº†ä¸¤ä¸ª reducer ï¼Œä¸€ä¸ªç®¡ç†å˜é‡ number ï¼Œä¸€ä¸ªä¿å­˜ä¿¡æ¯ info ã€‚</li>
</ul>
<p><strong>ç¬¬äºŒæ­¥ï¼šæ³¨å†Œä¸­é—´ä»¶</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æ‰“å°ä¸­é—´ä»¶ */</span></span><br><span class="line"><span class="comment">/* ç¬¬ä¸€å±‚åœ¨ compose ä¸­è¢«æ‰§è¡Œ */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">logMiddleware</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">/* ç¬¬äºŒå±‚åœ¨reduceä¸­è¢«æ‰§è¡Œ */</span> </span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">next</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">/* è¿”å›å¢å¼ºåçš„dispatch */</span></span><br><span class="line">      <span class="keyword">return</span> <span class="function">(<span class="params">action</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; type &#125; = action</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å‘ç”Ÿä¸€æ¬¡action:&#x27;</span>, type )</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">next</span>(action)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åœ¨é‡ç‚¹çœ‹ä¸€ä¸‹ redux çš„ä¸­é—´ä»¶çš„ç¼–å†™æ–¹å¼ï¼Œæœ¬è´¨ä¸Šåº”ç”¨äº†å‡½æ•°æŸ¯é‡ŒåŒ–ã€‚</li>
</ul>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šç”ŸæˆStore</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æ³¨å†Œä¸­é—´ä»¶  */</span></span><br><span class="line"><span class="keyword">const</span> rootMiddleware = <span class="title function_">applyMiddleware</span>(logMiddleware)</span><br><span class="line"><span class="comment">/* æ³¨å†Œreducer */</span></span><br><span class="line"><span class="keyword">const</span> rootReducer = <span class="title function_">combineReducers</span>(&#123; <span class="attr">number</span>:numberReducer,<span class="attr">info</span>:<span class="title class_">InfoReducer</span>  &#125;)</span><br><span class="line"><span class="comment">/* åˆæˆStore */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Store</span> = <span class="title function_">createStore</span>(rootReducer,&#123; <span class="attr">number</span>:<span class="number">1</span> , <span class="attr">info</span>:&#123; <span class="attr">name</span>:<span class="literal">null</span> &#125; &#125; ,rootMiddleware) </span><br></pre></td></tr></table></figure>
<ul>
<li>è¿™ä¸€æ­¥æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œç›´æ¥æ³¨å†Œå°±å¯ä»¥äº†ã€‚</li>
</ul>
<p><strong>ç¬¬å››æ­¥ï¼šè¯•ç”¨redux</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Index</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> [ state , changeState  ] = <span class="title function_">useState</span>(<span class="title class_">Store</span>.<span class="title function_">getState</span>())</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">/* è®¢é˜…state */</span></span><br><span class="line">    <span class="keyword">const</span> unSubscribe = <span class="title class_">Store</span>.<span class="title function_">subscribe</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">         <span class="title function_">changeState</span>(<span class="title class_">Store</span>.<span class="title function_">getState</span>())</span><br><span class="line">     &#125;)</span><br><span class="line">    <span class="comment">/* è§£é™¤è®¢é˜… */</span></span><br><span class="line">     <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="title function_">unSubscribe</span>()</span><br><span class="line">  &#125;,[])</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> &gt;</span> </span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>  &#123; state.info.name ? `hello, my name is $&#123; state.info.name&#125;` : &#x27;what is your name&#x27; &#125; ,</span></span><br><span class="line"><span class="language-xml">           &#123; state.info.mes ? state.info.mes  : &#x27; what do you say? &#x27;  &#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         ã€ŠReactè¿›é˜¶å®è·µæŒ‡å—ã€‹ &#123; state.number &#125; ğŸ‘ <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123; Store.dispatch(&#123; type:&#x27;ADD&#x27; &#125;)  &#125;&#125; &gt;ç‚¹èµ<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123; Store.dispatch(&#123; type:&#x27;SET&#x27;,payload:&#123; name:&#x27;alien&#x27; , mes:&#x27;let us learn React!&#x27;  &#125; &#125;) &#125;&#125; &gt;ä¿®æ”¹æ ‡é¢˜<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¸ºäº†è®©å¤§å®¶ç›´è§‚çœ‹åˆ°æ•ˆæœï¼Œå¯ä»¥ç›´æ¥æŠŠ redux å’Œ react ç›´æ¥ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œåœ¨ useEffect ä¸­è¿›è¡Œè®¢é˜…å’Œè§£é™¤è®¢é˜…ï¼Œé€šè¿‡ useState æ”¹å˜è§†å›¾å±‚ã€‚</li>
<li>store.getState å¯ä»¥è·å– redux æœ€æ–°çš„ state ã€‚</li>
</ul>
<p><strong>æ•ˆæœ</strong></p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261717006.gif" alt="1.gif"></p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<p>ä¸Šè¿°demoä¸­ï¼Œæ²¡æœ‰ç”¨åˆ° react-redux ï¼Œä½†æ˜¯æ˜æ˜¾æš´éœ²äº†å¾ˆå¤šé—®é¢˜ã€‚æˆ‘æ¥åšä¸€ä¸‹æ€»ç»“ï¼š</p>
<ul>
<li>1 é¦–å…ˆæƒ³è¦çš„çŠ¶æ€æ˜¯å…±ç”¨çš„ï¼Œä¸Šè¿° demo æ— æ³•æ»¡è¶³çŠ¶æ€å…±ç”¨çš„æƒ…å†µã€‚</li>
<li>2 æ­£å¸¸æƒ…å†µä¸å¯èƒ½å°†æ¯ä¸€ä¸ªéœ€è¦çŠ¶æ€çš„ç»„ä»¶éƒ½ç”¨ subscribe &#x2F; unSubscribe æ¥è¿›è¡Œè®¢é˜…</li>
<li>3 æ¯”å¦‚ A ç»„ä»¶éœ€è¦çŠ¶æ€ aï¼ŒB ç»„ä»¶éœ€è¦çŠ¶æ€ b ï¼Œé‚£ä¹ˆæ”¹å˜ aï¼Œåªå¸Œæœ› A ç»„ä»¶æ›´æ–°ï¼Œä¸å¸Œæœ› B ç»„ä»¶æ›´æ–°ï¼Œæ˜¾ç„¶ä¸Šè¿°æ˜¯ä¸èƒ½æ»¡è¶³çš„ã€‚</li>
<li>4 â€¦</li>
</ul>
<p>æ‰€ä»¥ä¸ºäº†è§£å†³ä¸Šè¿°è¯¸å¤šé—®é¢˜ï¼Œreact-redux å°±åº”è¿è€Œç”Ÿäº†ã€‚</p>
<h2 id="äºŒ-React-Reduxç”¨æ³•"><a href="#äºŒ-React-Reduxç”¨æ³•" class="headerlink" title="äºŒ React-Reduxç”¨æ³•"></a>äºŒ React-Reduxç”¨æ³•</h2><p>ä¸Šè¿°è®²åˆ° React-Redux æ˜¯æ²Ÿé€š React å’Œ Redux çš„æ¡¥æ¢ï¼Œå®ƒä¸»è¦åŠŸèƒ½ä½“ç°åœ¨å¦‚ä¸‹ä¸¤ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>1 æ¥å— Redux çš„ Storeï¼Œå¹¶æŠŠå®ƒåˆç†åˆ†é…åˆ°æ‰€éœ€è¦çš„ç»„ä»¶ä¸­ã€‚</li>
<li>2 è®¢é˜… Store ä¸­ state çš„æ”¹å˜ï¼Œä¿ƒä½¿æ¶ˆè´¹å¯¹åº”çš„ state çš„ç»„ä»¶æ›´æ–°ã€‚</li>
</ul>
<h3 id="1-ç”¨æ³•ç®€ä»‹"><a href="#1-ç”¨æ³•ç®€ä»‹" class="headerlink" title="1 ç”¨æ³•ç®€ä»‹"></a>1 ç”¨æ³•ç®€ä»‹</h3><h4 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h4><p>ç”±äº redux æ•°æ®å±‚ï¼Œå¯èƒ½è¢«å¾ˆå¤šç»„ä»¶æ¶ˆè´¹ï¼Œæ‰€ä»¥ react-redux ä¸­æä¾›äº†ä¸€ä¸ª Provider ç»„ä»¶ï¼Œå¯ä»¥å…¨å±€æ³¨å…¥ redux ä¸­çš„ store ï¼Œæ‰€ä»¥ä½¿ç”¨è€…éœ€è¦æŠŠ Provider æ³¨å†Œåˆ°æ ¹éƒ¨ç»„ä»¶ä¸­ã€‚</p>
<ul>
<li>Provider ä½œç”¨å°±æ˜¯ä¿å­˜ redux ä¸­çš„ store ï¼Œåˆ†é…ç»™æ‰€æœ‰éœ€è¦ state çš„å­å­™ç»„ä»¶ã€‚</li>
</ul>
<p>ä¾‹å­ğŸŒ°ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Root</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;Store&#125;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Index</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h4><p>æ—¢ç„¶å·²ç»å…¨å±€æ³¨å…¥äº† Store ï¼Œé‚£ä¹ˆéœ€è¦ Store ä¸­çš„çŠ¶æ€æˆ–è€…æƒ³è¦æ”¹å˜Storeçš„çŠ¶æ€ï¼Œé‚£ä¹ˆå¦‚ä½•å¤„ç†å‘¢ï¼ŒReact-Redux æä¾›äº†ä¸€ä¸ªé«˜é˜¶ç»„ä»¶connectï¼Œè¢« connect åŒ…è£…åç»„ä»¶å°†è·å¾—å¦‚ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>1 èƒ½å¤Ÿä» props ä¸­è·å–æ”¹å˜ state çš„æ–¹æ³• Store.dispatch ã€‚</li>
<li>2 å¦‚æœ connect æœ‰ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆä¼šå°† redux state ä¸­çš„æ•°æ®ï¼Œæ˜ å°„åˆ°å½“å‰ç»„ä»¶çš„ props ä¸­ï¼Œå­ç»„ä»¶å¯ä»¥ä½¿ç”¨æ¶ˆè´¹ã€‚</li>
<li>3 å½“éœ€è¦çš„ state ï¼Œæœ‰å˜åŒ–çš„æ—¶å€™ï¼Œä¼šé€šçŸ¥å½“å‰ç»„ä»¶æ›´æ–°ï¼Œé‡æ–°æ¸²æŸ“è§†å›¾ã€‚</li>
</ul>
<p>å¼€å‘è€…å¯ä»¥åˆ©ç”¨ connect æä¾›çš„åŠŸèƒ½ï¼Œåšæ•°æ®è·å–ï¼Œæ•°æ®é€šä¿¡ï¼ŒçŠ¶æ€æ´¾å‘ç­‰æ“ä½œã€‚é¦–å…ˆæ¥çœ‹çœ‹ connect ç”¨æ³•ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">connect</span>(<span class="params">mapStateToProps?, mapDispatchToProps?, mergeProps?, options?</span>)</span><br></pre></td></tr></table></figure>

<p><strong>â‘ mapStateToProps</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">mapStateToProps</span> = state =&gt; (&#123; <span class="attr">number</span>: state.<span class="property">number</span> &#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>ç»„ä»¶ä¾èµ– redux çš„ stateï¼Œæ˜ å°„åˆ°ä¸šåŠ¡ç»„ä»¶çš„ props ä¸­ï¼Œstate æ”¹å˜è§¦å‘ï¼Œä¸šåŠ¡ç»„ä»¶ props æ”¹å˜ï¼Œè§¦å‘ä¸šåŠ¡ç»„ä»¶æ›´æ–°è§†å›¾ã€‚å½“è¿™ä¸ªå‚æ•°æ²¡æœ‰çš„æ—¶å€™ï¼Œå½“å‰ç»„ä»¶ä¸ä¼šè®¢é˜… store çš„æ”¹å˜ã€‚</li>
</ul>
<p><strong>â‘¡mapDispatchToProps</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">mapDispatchToProps</span> = dispatch =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">numberAdd</span>: <span class="function">() =&gt;</span> <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;ADD&#x27;</span> &#125;),</span><br><span class="line">    <span class="attr">setInfo</span>: <span class="function">() =&gt;</span> <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;SET&#x27;</span> &#125;),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>å°† redux ä¸­çš„ dispatch æ–¹æ³•ï¼Œæ˜ å°„åˆ°ä¸šåŠ¡ç»„ä»¶çš„ props ä¸­ã€‚æ¯”å¦‚å°†å¦‚ä¸Š demo ä¸­çš„ä¸¤ä¸ªæ–¹æ³•æ˜ å°„åˆ° props ï¼Œå˜æˆäº† numberAdd ï¼Œ setInfo æ–¹æ³•ã€‚</li>
</ul>
<p><strong>â‘¢mergeProps</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* stateProps , state æ˜ å°„åˆ° props ä¸­çš„å†…å®¹</span></span><br><span class="line"><span class="comment">* dispatchPropsï¼Œ dispatch æ˜ å°„åˆ° props ä¸­çš„å†…å®¹ã€‚</span></span><br><span class="line"><span class="comment">* ownProps ç»„ä»¶æœ¬èº«çš„ props</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">(stateProps, dispatchProps, ownProps) =&gt; <span class="title class_">Object</span></span><br></pre></td></tr></table></figure>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªå‚æ•°ï¼Œä¼šæŒ‰ç…§å¦‚ä¸‹æ–¹å¼è¿›è¡Œåˆå¹¶ï¼Œè¿”å›çš„å¯¹è±¡å¯ä»¥æ˜¯ï¼Œå¯ä»¥è‡ªå®šä¹‰çš„åˆå¹¶è§„åˆ™ï¼Œè¿˜å¯ä»¥é™„åŠ ä¸€äº›å±æ€§ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; ...ownProps, ...stateProps, ...dispatchProps &#125;</span><br></pre></td></tr></table></figure>

<p><strong>â‘£options</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  context?: <span class="title class_">Object</span>,   <span class="comment">// è‡ªå®šä¹‰ä¸Šä¸‹æ–‡</span></span><br><span class="line">  pure?: boolean, <span class="comment">// é»˜è®¤ä¸º true , å½“ä¸º true çš„æ—¶å€™ ï¼Œé™¤äº† mapStateToProps å’Œ props ,å…¶ä»–è¾“å…¥æˆ–è€…state æ”¹å˜ï¼Œå‡ä¸ä¼šæ›´æ–°ç»„ä»¶ã€‚</span></span><br><span class="line">  areStatesEqual?: <span class="title class_">Function</span>, <span class="comment">// å½“pure true , æ¯”è¾ƒå¼•è¿›store ä¸­stateå€¼ æ˜¯å¦å’Œä¹‹å‰ç›¸ç­‰ã€‚ (next: Object, prev: Object) =&gt; boolean</span></span><br><span class="line">  areOwnPropsEqual?: <span class="title class_">Function</span>, <span class="comment">// å½“pure true , æ¯”è¾ƒ props å€¼, æ˜¯å¦å’Œä¹‹å‰ç›¸ç­‰ã€‚ (next: Object, prev: Object) =&gt; boolean</span></span><br><span class="line">  areStatePropsEqual?: <span class="title class_">Function</span>, <span class="comment">// å½“pure true , æ¯”è¾ƒ mapStateToProps åçš„å€¼ æ˜¯å¦å’Œä¹‹å‰ç›¸ç­‰ã€‚  (next: Object, prev: Object) =&gt; boolean</span></span><br><span class="line">  areMergedPropsEqual?: <span class="title class_">Function</span>, <span class="comment">// å½“ pure ä¸º true æ—¶ï¼Œ æ¯”è¾ƒ ç»è¿‡ mergeProps åˆå¹¶åçš„å€¼ ï¼Œ æ˜¯å¦ä¸ä¹‹å‰ç­‰  (next: Object, prev: Object) =&gt; boolean</span></span><br><span class="line">  forwardRef?: boolean, <span class="comment">//å½“ä¸ºtrue æ—¶å€™,å¯ä»¥é€šè¿‡ref è·å–è¢«connectåŒ…è£¹çš„ç»„ä»¶å®ä¾‹ã€‚</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šæ ‡æ³¨äº† options å±æ€§æ¯ä¸€ä¸ªçš„å«ä¹‰ã€‚å¹¶ä¸”è®²è§£äº† react-redux çš„åŸºæœ¬ç”¨æ³•ï¼Œæ¥ä¸‹æ¥ç®€å•å®ç° react-redux çš„ä¸¤ä¸ªåŠŸèƒ½ã€‚</p>
<h3 id="2-å®è·µä¸€ï¼šReact-Reduxå®ç°çŠ¶æ€å…±äº«"><a href="#2-å®è·µä¸€ï¼šReact-Reduxå®ç°çŠ¶æ€å…±äº«" class="headerlink" title="2 å®è·µä¸€ï¼šReact-Reduxå®ç°çŠ¶æ€å…±äº«"></a>2 å®è·µä¸€ï¼šReact-Reduxå®ç°çŠ¶æ€å…±äº«</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Root</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title class_">React</span>.<span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="title class_">Store</span>.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>:<span class="string">&#x27;ADD&#x27;</span>&#125;)</span><br><span class="line">    <span class="title class_">Store</span>.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>:<span class="string">&#x27;SET&#x27;</span>,<span class="attr">payload</span>:&#123; <span class="attr">name</span>:<span class="string">&#x27;alien&#x27;</span> , <span class="attr">mes</span>:<span class="string">&#x27;let us learn React!&#x27;</span>  &#125; &#125;)</span><br><span class="line">  &#125;,[])</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;Store&#125;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Index</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡åœ¨æ ¹ç»„ä»¶ä¸­æ³¨å…¥ store ï¼Œå¹¶åœ¨ useEffect ä¸­æ”¹å˜ state å†…å®¹ã€‚</li>
</ul>
<p>ç„¶ååœ¨æ•´ä¸ªåº”ç”¨ä¸­åœ¨æƒ³è¦è·å–æ•°æ®çš„ç»„ä»¶é‡Œï¼Œè·å– state ä¸­çš„å†…å®¹ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Index</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">         <span class="keyword">const</span> &#123; info , number &#125;:any = <span class="variable language_">this</span>.<span class="property">props</span>  </span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>  &#123;info.name ? `hello, my name is $&#123;info.name&#125;` : &#x27;what is your name&#x27;&#125; ,</span></span><br><span class="line"><span class="language-xml">          &#123;info.mes ? info.mes : &#x27; what do you say? &#x27;&#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ã€ŠReactè¿›é˜¶å®è·µæŒ‡å—ã€‹ &#123;number&#125; ğŸ‘ <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mapStateToProps</span> = state =&gt; (&#123; <span class="attr">number</span>: state.<span class="property">number</span>, <span class="attr">info</span>: state.<span class="property">info</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(mapStateToProps)(<span class="title class_">Index</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡ mapStateToProps è·å–æŒ‡å®š state ä¸­çš„å†…å®¹ï¼Œç„¶åæ¸²æŸ“è§†å›¾ã€‚</li>
</ul>
<p>æ•ˆæœï¼š</p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261717061.jpeg" alt="5.jpg"></p>
<h3 id="3-å®è·µäºŒï¼šReact-Reduxå®ç°ç»„ä»¶é€šä¿¡"><a href="#3-å®è·µäºŒï¼šReact-Reduxå®ç°ç»„ä»¶é€šä¿¡" class="headerlink" title="3 å®è·µäºŒï¼šReact-Reduxå®ç°ç»„ä»¶é€šä¿¡"></a>3 å®è·µäºŒï¼šReact-Reduxå®ç°ç»„ä»¶é€šä¿¡</h3><p>æ¥ä¸‹æ¥å¯ä»¥ç”¨ React-Redux æ¨¡æ‹Ÿä¸€ä¸ªï¼Œç»„ä»¶é€šä¿¡çš„åœºæ™¯ã€‚</p>
<p><strong>ç»„ä»¶A</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ComponentA</span>(<span class="params">&#123; toCompB, compBsay &#125;</span>) &#123; <span class="comment">/* ç»„ä»¶A */</span></span><br><span class="line">  <span class="keyword">const</span> [<span class="title class_">CompAsay</span>, setCompAsay] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;box&quot;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯ç»„ä»¶A<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span> Bç»„ä»¶å¯¹æˆ‘è¯´ï¼š&#123;compBsay&#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        æˆ‘å¯¹Bç»„ä»¶è¯´ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">&quot;CompAsay&quot;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> setCompAsay(e.target.value)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> toCompB(CompAsay)&#125; &gt;ç¡®å®š<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* æ˜ å°„stateä¸­CompBsay  */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">CompAMapStateToProps</span> = state =&gt; (&#123; <span class="attr">compBsay</span>: state.<span class="property">info</span>.<span class="property">compBsay</span> &#125;)</span><br><span class="line"><span class="comment">/* æ˜ å°„toCompBæ–¹æ³•åˆ°propsä¸­ */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">CompAmapDispatchToProps</span> = dispatch =&gt; (&#123; <span class="attr">toCompB</span>: <span class="function">(<span class="params">mes</span>) =&gt;</span> <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;SET&#x27;</span>, <span class="attr">payload</span>: &#123; <span class="attr">compAsay</span>: mes &#125; &#125;) &#125;)</span><br><span class="line"><span class="comment">/* connectåŒ…è£…ç»„ä»¶A */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">CompA</span> = <span class="title function_">connect</span>(<span class="title class_">CompAMapStateToProps</span>, <span class="title class_">CompAmapDispatchToProps</span>)(<span class="title class_">ComponentA</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>ç»„ä»¶ A é€šè¿‡ mapStateToPropsï¼ŒmapDispatchToPropsï¼Œåˆ†åˆ«å°†state ä¸­çš„ compBsay å±æ€§ï¼Œå’Œæ”¹å˜ state çš„ compAsay æ–¹æ³•ï¼Œæ˜ å°„åˆ° props ä¸­ã€‚</li>
</ul>
<p><strong>ç»„ä»¶B</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ComponentB</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123; <span class="comment">/* Bç»„ä»¶ */</span></span><br><span class="line">  state=&#123; <span class="attr">compBsay</span>:<span class="string">&#x27;&#x27;</span> &#125;</span><br><span class="line">  handleToA=<span class="function">()=&gt;</span>&#123;</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;SET&#x27;</span>, <span class="attr">payload</span>: &#123; <span class="attr">compBsay</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">compBsay</span> &#125; &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;box&quot;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>æˆ‘æ˜¯ç»„ä»¶B<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span> Aç»„ä»¶å¯¹æˆ‘è¯´ï¼š&#123; this.props.compAsay &#125; <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       æˆ‘å¯¹Aç»„ä»¶è¯´ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">&quot;CompBsay&quot;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span>=&gt;</span> this.setState(&#123; compBsay: e.target.value  &#125;) &#125;  /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span>  <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.handleToA</span> &#125; &gt;</span>ç¡®å®š<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* æ˜ å°„stateä¸­ CompAsay  */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">CompBMapStateToProps</span> = state =&gt; (&#123; <span class="attr">compAsay</span>: state.<span class="property">info</span>.<span class="property">compAsay</span> &#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">CompB</span> =  <span class="title function_">connect</span>(<span class="title class_">CompBMapStateToProps</span>)(<span class="title class_">ComponentB</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>B ç»„ä»¶å’Œ A ç»„ä»¶å·®ä¸å¤šï¼Œé€šè¿‡è§¦å‘ dispatch å‘ç»„ä»¶ A ä¼ é€’ä¿¡æ¯ï¼ŒåŒæ—¶æ¥å— B ç»„ä»¶çš„ä¿¡æ¯ã€‚</li>
</ul>
<p><strong>æ•ˆæœï¼š</strong></p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261717922.gif" alt="2.gif"></p>
<h2 id="ä¸‰-React-ReduxåŸç†"><a href="#ä¸‰-React-ReduxåŸç†" class="headerlink" title="ä¸‰ React-ReduxåŸç†"></a>ä¸‰ React-ReduxåŸç†</h2><p>å¯¹äº React-Redux åŸç†ï¼Œæˆ‘æŒ‰ç…§åŠŸèƒ½ç»„æˆï¼Œå¤§è‡´åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œæ¥ä¸‹æ¥å°†æŒ‰ç…§è¿™ä¸‰éƒ¨åˆ†é€ä¸€å‡»ç ´ï¼š</p>
<h3 id="ç¬¬ä¸€éƒ¨åˆ†ï¼š-Provideræ³¨å…¥Store"><a href="#ç¬¬ä¸€éƒ¨åˆ†ï¼š-Provideræ³¨å…¥Store" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†ï¼š Provideræ³¨å…¥Store"></a>ç¬¬ä¸€éƒ¨åˆ†ï¼š Provideræ³¨å…¥Store</h3><blockquote>
<p>react-redux&#x2F;src&#x2F;components&#x2F;Provider.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">ReactReduxContext</span> =  <span class="title class_">React</span>.<span class="title function_">createContext</span>(<span class="literal">null</span>)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Provider</span>(<span class="params">&#123; store, context, children &#125;</span>) &#123;</span><br><span class="line">   <span class="comment">/* åˆ©ç”¨useMemoï¼Œè·Ÿæ®storeå˜åŒ–åˆ›å»ºå‡ºä¸€ä¸ªcontextValue åŒ…å«ä¸€ä¸ªæ ¹å…ƒç´ è®¢é˜…å™¨å’Œå½“å‰store  */</span> </span><br><span class="line">  <span class="keyword">const</span> contextValue = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">/* åˆ›å»ºäº†ä¸€ä¸ªæ ¹çº§ Subscription è®¢é˜…å™¨ */</span></span><br><span class="line">    <span class="keyword">const</span> subscription = <span class="keyword">new</span> <span class="title class_">Subscription</span>(store)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      store,</span><br><span class="line">      subscription</span><br><span class="line">    &#125; <span class="comment">/* store æ”¹å˜åˆ›å»ºæ–°çš„contextValue */</span></span><br><span class="line">  &#125;, [store])</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; subscription &#125; = contextValue</span><br><span class="line">    <span class="comment">/* è§¦å‘trySubscribeæ–¹æ³•æ‰§è¡Œï¼Œåˆ›å»ºlistens */</span></span><br><span class="line">    subscription.<span class="title function_">trySubscribe</span>() <span class="comment">// å‘èµ·è®¢é˜…</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      subscription.<span class="title function_">tryUnsubscribe</span>()  <span class="comment">// å¸è½½è®¢é˜…</span></span><br><span class="line">    &#125; </span><br><span class="line">  &#125;, [contextValue])  <span class="comment">/*  contextValue state æ”¹å˜å‡ºå‘æ–°çš„ effect */</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title class_">Context</span> = <span class="title class_">ReactReduxContext</span></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Context.Provider</span> <span class="attr">value</span>=<span class="string">&#123;contextValue&#125;</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">Context.Provider</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¿ç•™äº†æ ¸å¿ƒçš„ä»£ç ã€‚ä»è¿™æ®µä»£ç ï¼Œä»ä¸­å¯ä»¥åˆ†æå‡º Provider åšäº†å“ªäº›äº‹ã€‚</p>
<ul>
<li>1 é¦–å…ˆçŸ¥é“ React-Redux æ˜¯é€šè¿‡ context ä¸Šä¸‹æ–‡æ¥ä¿å­˜ä¼ é€’ Store çš„ï¼Œä½†æ˜¯ä¸Šä¸‹æ–‡ value ä¿å­˜çš„é™¤äº† Store è¿˜æœ‰ subscription ã€‚</li>
<li>2 subscription å¯ä»¥ç†è§£ä¸ºè®¢é˜…å™¨ï¼Œåœ¨ React-redux ä¸­ä¸€æ–¹é¢ç”¨æ¥è®¢é˜…æ¥è‡ª state å˜åŒ–ï¼Œå¦ä¸€æ–¹é¢é€šçŸ¥å¯¹åº”çš„ç»„ä»¶æ›´æ–°ã€‚åœ¨ Provider ä¸­çš„è®¢é˜…å™¨ subscription ä¸ºæ ¹è®¢é˜…å™¨ï¼Œ</li>
<li>3 åœ¨ Provider çš„ useEffect ä¸­ï¼Œè¿›è¡ŒçœŸæ­£çš„ç»‘å®šè®¢é˜…åŠŸèƒ½ï¼Œå…¶åŸç†å†…éƒ¨è°ƒç”¨äº† store.subscribe ï¼Œåªæœ‰æ ¹è®¢é˜…å™¨æ‰ä¼šè§¦å‘store.subscribeï¼Œè‡³äºä¸ºä»€ä¹ˆï¼Œé©¬ä¸Šå°±ä¼šè®²åˆ°ã€‚</li>
</ul>
<h3 id="ç¬¬äºŒéƒ¨åˆ†ï¼š-Subscriptionè®¢é˜…å™¨"><a href="#ç¬¬äºŒéƒ¨åˆ†ï¼š-Subscriptionè®¢é˜…å™¨" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†ï¼š Subscriptionè®¢é˜…å™¨"></a>ç¬¬äºŒéƒ¨åˆ†ï¼š Subscriptionè®¢é˜…å™¨</h3><blockquote>
<p>react-redux&#x2F;src&#x2F;utils&#x2F;Subscription.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å‘å¸ƒè®¢é˜…è€…æ¨¡å¼ */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Subscription</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">store, parentSub</span>) &#123;</span><br><span class="line">  <span class="comment">//....</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* è´Ÿè´£æ£€æµ‹æ˜¯å¦è¯¥ç»„ä»¶è®¢é˜…ï¼Œç„¶åæ·»åŠ è®¢é˜…è€…ä¹Ÿå°±æ˜¯listener */</span></span><br><span class="line">  <span class="title function_">addNestedSub</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">trySubscribe</span>()</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">listeners</span>.<span class="title function_">subscribe</span>(listener)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* å‘listenerså‘å¸ƒé€šçŸ¥ */</span></span><br><span class="line">  <span class="title function_">notifyNestedSubs</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">listeners</span>.<span class="title function_">notify</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* å¼€å¯è®¢é˜…æ¨¡å¼ é¦–å…ˆåˆ¤æ–­å½“å‰è®¢é˜…å™¨æœ‰æ²¡æœ‰çˆ¶çº§è®¢é˜…å™¨ ï¼Œ å¦‚æœæœ‰çˆ¶çº§è®¢é˜…å™¨(å°±æ˜¯çˆ¶çº§Subscription)ï¼ŒæŠŠè‡ªå·±çš„handleChangeWrapperæ”¾å…¥åˆ°ç›‘å¬è€…é“¾è¡¨ä¸­ */</span></span><br><span class="line">  <span class="title function_">trySubscribe</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    parentSub  å³æ˜¯provide value é‡Œé¢çš„ Subscription è¿™é‡Œå¯ä»¥ç†è§£ä¸º çˆ¶çº§å…ƒç´ çš„ Subscription</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">unsubscribe</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">unsubscribe</span> = <span class="variable language_">this</span>.<span class="property">parentSub</span></span><br><span class="line">        ? <span class="variable language_">this</span>.<span class="property">parentSub</span>.<span class="title function_">addNestedSub</span>(<span class="variable language_">this</span>.<span class="property">handleChangeWrapper</span>)</span><br><span class="line">        <span class="comment">/* providerçš„Subscriptionæ˜¯ä¸å­˜åœ¨parentSubï¼Œæ‰€ä»¥æ­¤æ—¶trySubscribe å°±ä¼šè°ƒç”¨ store.subscribe   */</span></span><br><span class="line">        : <span class="variable language_">this</span>.<span class="property">store</span>.<span class="title function_">subscribe</span>(<span class="variable language_">this</span>.<span class="property">handleChangeWrapper</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">listeners</span> = <span class="title function_">createListenerCollection</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* å–æ¶ˆè®¢é˜… */</span></span><br><span class="line">  <span class="title function_">tryUnsubscribe</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="comment">//....</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ•´ä¸ªè®¢é˜…å™¨çš„æ ¸å¿ƒï¼Œæˆ‘æµ“ç¼©æç‚¼æˆ8ä¸ªå­—ï¼š<strong>å±‚å±‚è®¢é˜…ï¼Œä¸Šè®¢ä¸‹å‘</strong>ã€‚</p>
<p><strong>å±‚å±‚è®¢é˜…</strong>ï¼šReact-Redux é‡‡ç”¨äº†å±‚å±‚è®¢é˜…çš„æ€æƒ³ï¼Œä¸Šè¿°å†…å®¹è®²åˆ° Provider é‡Œé¢æœ‰ä¸€ä¸ª Subscription ï¼Œæå‰é€éœ²ä¸€ä¸‹ï¼Œæ¯ä¸€ä¸ªç”¨ connect åŒ…è£…çš„ç»„ä»¶ï¼Œå†…éƒ¨ä¹Ÿæœ‰ä¸€ä¸ª Subscription ï¼Œè€Œä¸”è¿™äº›è®¢é˜…å™¨ä¸€å±‚å±‚å»ºç«‹èµ·å…³è”ï¼ŒProviderä¸­çš„è®¢é˜…å™¨æ˜¯æœ€æ ¹éƒ¨çš„è®¢é˜…å™¨ï¼Œå¯ä»¥é€šè¿‡ trySubscribe å’Œ addNestedSub æ–¹æ³•å¯ä»¥çœ‹åˆ°ã€‚è¿˜æœ‰ä¸€ä¸ªæ³¨æ„çš„ç‚¹å°±æ˜¯ï¼Œå¦‚æœçˆ¶ç»„ä»¶æ˜¯ä¸€ä¸ª connect ï¼Œå­å­™ç»„ä»¶ä¹Ÿæœ‰ connect ï¼Œé‚£ä¹ˆçˆ¶å­ connect çš„ Subscription ä¹Ÿä¼šå»ºç«‹èµ·çˆ¶å­å…³ç³»ã€‚</p>
<p><strong>ä¸Šè®¢ä¸‹å‘</strong>ï¼šåœ¨è°ƒç”¨ trySubscribe çš„æ—¶å€™ï¼Œèƒ½å¤Ÿçœ‹åˆ°è®¢é˜…å™¨ä¼šå’Œä¸Šä¸€çº§çš„è®¢é˜…å™¨é€šè¿‡ addNestedSub å»ºç«‹èµ·å…³è”ï¼Œå½“ store ä¸­ state å‘ç”Ÿæ”¹å˜ï¼Œä¼šè§¦å‘ store.subscribe ï¼Œä½†æ˜¯åªä¼šé€šçŸ¥ç»™ Provider ä¸­çš„æ ¹Subscriptionï¼Œæ ¹ Subscription ä¹Ÿä¸ä¼šç›´æ¥æ´¾å‘æ›´æ–°ï¼Œè€Œæ˜¯ä¼šä¸‹å‘ç»™å­ä»£è®¢é˜…å™¨ï¼ˆ connect ä¸­çš„ Subscription ï¼‰ï¼Œå†ç”±å­ä»£è®¢é˜…å™¨ï¼Œå†³å®šæ˜¯å¦æ›´æ–°ç»„ä»¶ï¼Œå±‚å±‚ä¸‹å‘ã€‚</p>
<p><strong>ï½œâ€”â€”â€“é—®ä¸ç­”â€”â€”â€“ï½œ</strong><br/><br>é—®ï¼šä¸ºä»€ä¹ˆ React-Redux ä¼šé‡‡ç”¨ subscription è®¢é˜…å™¨è¿›è¡Œè®¢é˜…ï¼Œè€Œä¸æ˜¯ç›´æ¥é‡‡ç”¨ store.subscribe å‘¢ ï¼Ÿ</p>
<ul>
<li><p>1 é¦–å…ˆ state çš„æ”¹å˜ï¼ŒProvider æ˜¯ä¸èƒ½ç›´æ¥ä¸‹å‘æ›´æ–°çš„ï¼Œå¦‚æœä¸‹å‘æ›´æ–°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ›´æ–°æ˜¯æ•´ä¸ªåº”ç”¨å±‚çº§ä¸Šçš„ï¼Œè¿˜æœ‰ä¸€ç‚¹ï¼Œå¦‚æœéœ€è¦ state çš„ç»„ä»¶ï¼Œåšä¸€äº›æ€§èƒ½ä¼˜åŒ–çš„ç­–ç•¥ï¼Œé‚£ä¹ˆè¯¥æ›´æ–°çš„ç»„ä»¶ä¸ä¼šè¢«æ›´æ–°ï¼Œä¸è¯¥æ›´æ–°çš„ç»„ä»¶åè€Œä¼šæ›´æ–°äº†ã€‚</p>
</li>
<li><p>2 çˆ¶ Subscription -&gt; å­ Subscription è¿™ç§æ¨¡å¼ï¼Œå¯ä»¥é€å±‚ç®¡ç† connect çš„çŠ¶æ€æ´¾å‘ï¼Œä¸ä¼šå› ä¸º state çš„æ”¹å˜è€Œå¯¼è‡´æ›´æ–°çš„æ··ä¹±ã€‚</p>
</li>
</ul>
<p><strong>ï½œâ€”â€”â€“ENDâ€”â€”â€“ï½œ</strong><br/></p>
<p><strong>å±‚å±‚è®¢é˜…æ¨¡å‹ï¼š</strong></p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261717056.jpeg" alt="6.jpg"></p>
<h3 id="ç¬¬ä¸‰éƒ¨åˆ†ï¼š-connectæ§åˆ¶æ›´æ–°"><a href="#ç¬¬ä¸‰éƒ¨åˆ†ï¼š-connectæ§åˆ¶æ›´æ–°" class="headerlink" title="ç¬¬ä¸‰éƒ¨åˆ†ï¼š connectæ§åˆ¶æ›´æ–°"></a>ç¬¬ä¸‰éƒ¨åˆ†ï¼š connectæ§åˆ¶æ›´æ–°</h3><p>ç”±äºconnectä¸­çš„ä»£ç è¿‡äºå¤æ‚ï¼Œæˆ‘è¿™é‡Œåªä¿ç•™æ ¸å¿ƒçš„æµç¨‹ï¼Œè€Œä¸”å¯¹ä»£ç è¿›è¡Œç®€åŒ–å¤„ç†ã€‚</p>
<blockquote>
<p>react-redux&#x2F;src&#x2F;components&#x2F;connectAdvanced.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">connect</span>(<span class="params">mapStateToProps,mapDispatchToProps</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">Context</span> = <span class="title class_">ReactReduxContext</span></span><br><span class="line">    <span class="comment">/* WrappedComponent ä¸ºconnect åŒ…è£¹çš„ç»„ä»¶æœ¬èº«  */</span>   </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">wrapWithConnect</span>(<span class="params">WrappedComponent</span>)&#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">createChildSelector</span>(<span class="params">store</span>) &#123;</span><br><span class="line">          <span class="comment">/* é€‰æ‹©å™¨  åˆå¹¶å‡½æ•° mergeprops */</span></span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">selectorFactory</span>(store.<span class="property">dispatch</span>, &#123; mapStateToProps,mapDispatchToProps &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* è´Ÿè´£æ›´æ–°ç»„ä»¶çš„å®¹å™¨ */</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">ConnectFunction</span>(<span class="params">props</span>)&#123;</span><br><span class="line">          <span class="comment">/* è·å– contextå†…å®¹ é‡Œé¢å«æœ‰ reduxä¸­store å’Œçˆ¶çº§subscription */</span></span><br><span class="line">          <span class="keyword">const</span> contextValue = <span class="title function_">useContext</span>(<span class="title class_">ContextToUse</span>)</span><br><span class="line">          <span class="comment">/* åˆ›å»ºå­é€‰æ‹©å™¨,ç”¨äºæå–stateä¸­çš„çŠ¶æ€å’Œdispatchæ˜ å°„ï¼Œåˆå¹¶åˆ°propsä¸­ */</span></span><br><span class="line">          <span class="keyword">const</span> childPropsSelector = <span class="title function_">createChildSelector</span>(contextValue.<span class="property">store</span>)</span><br><span class="line">          <span class="keyword">const</span> [subscription, notifyNestedSubs] = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">/* åˆ›å»ºä¸€ä¸ªå­ä»£Subscriptionï¼Œå¹¶å’Œçˆ¶çº§subscriptionå»ºç«‹èµ·å…³ç³» */</span></span><br><span class="line">            <span class="keyword">const</span> subscription = <span class="keyword">new</span> <span class="title class_">Subscription</span>(</span><br><span class="line">              store,</span><br><span class="line">              didStoreComeFromProps ? <span class="literal">null</span> : contextValue.<span class="property">subscription</span> <span class="comment">// çˆ¶çº§subscriptionï¼Œé€šè¿‡è¿™ä¸ªå’Œçˆ¶çº§è®¢é˜…å™¨å»ºç«‹èµ·å…³è”ã€‚</span></span><br><span class="line">            )</span><br><span class="line">             <span class="keyword">return</span> [subscription, subscription.<span class="property">notifyNestedSubs</span>]</span><br><span class="line">            &#125;, [store, didStoreComeFromProps, contextValue])</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/* åˆæˆçš„çœŸæ­£çš„props */</span></span><br><span class="line">            <span class="keyword">const</span> actualChildProps = <span class="title function_">childPropsSelector</span>(store.<span class="title function_">getState</span>(), wrapperProps)</span><br><span class="line">            <span class="keyword">const</span> lastChildProps = <span class="title function_">useRef</span>()</span><br><span class="line">            <span class="comment">/* æ›´æ–°å‡½æ•° */</span></span><br><span class="line">            <span class="keyword">const</span> [ forceUpdate, ] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">            <span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">const</span> <span class="title function_">checkForUpdates</span> =(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">                   newChildProps = <span class="title function_">childPropsSelector</span>()</span><br><span class="line">                  <span class="keyword">if</span> (newChildProps === lastChildProps.<span class="property">current</span>) &#123; </span><br><span class="line">                      <span class="comment">/* è®¢é˜…çš„stateæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆè¯¥ç»„ä»¶ä¸éœ€è¦æ›´æ–°ï¼Œé€šçŸ¥å­ä»£è®¢é˜…å™¨ */</span></span><br><span class="line">                      <span class="title function_">notifyNestedSubs</span>() </span><br><span class="line">                  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                     <span class="comment">/* è¿™ä¸ªæ‰æ˜¯çœŸæ­£çš„è§¦å‘ç»„ä»¶æ›´æ–°çš„å‡½æ•° */</span></span><br><span class="line">                     <span class="title function_">forceUpdate</span>(<span class="function"><span class="params">state</span>=&gt;</span>state+<span class="number">1</span>)</span><br><span class="line">                     lastChildProps.<span class="property">current</span> = newChildProps <span class="comment">/* ä¿å­˜ä¸Šä¸€æ¬¡çš„props */</span></span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                subscription.<span class="property">onStateChange</span> = checkForUpdates</span><br><span class="line">                <span class="comment">//å¼€å¯è®¢é˜…è€… ï¼Œå½“å‰æ˜¯è¢«connect åŒ…è½¬çš„æƒ…å†µ ä¼šæŠŠ å½“å‰çš„ checkForceUpdate æ”¾åœ¨å­˜å…¥ çˆ¶å…ƒç´ çš„addNestedSubä¸­ ï¼Œä¸€ç‚¹ç‚¹å‘ä¸Šçº§ä¼ é€’ æœ€åä¼ åˆ° provide </span></span><br><span class="line">                subscription.<span class="title function_">trySubscribe</span>()</span><br><span class="line">                <span class="comment">/* å…ˆæ£€æŸ¥ä¸€éï¼Œåæ­£åˆå§‹åŒ–stateå°±å˜äº† */</span></span><br><span class="line">                <span class="title function_">checkForUpdates</span>()</span><br><span class="line">            &#125;,[store, subscription, childPropsSelector])</span><br><span class="line"></span><br><span class="line">             <span class="comment">/* åˆ©ç”¨ Provider ç‰¹æ€§é€å±‚ä¼ é€’æ–°çš„ subscription */</span></span><br><span class="line">            <span class="keyword">return</span>  <span class="language-xml"><span class="tag">&lt;<span class="name">ContextToUse.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span>  <span class="attr">...contextValue</span>, <span class="attr">subscription</span>&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">WrappedComponent</span>  &#123;<span class="attr">...actualChildProps</span>&#125;  /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">ContextToUse.Provider</span>&gt;</span></span>  </span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">/* memo ä¼˜åŒ–å¤„ç† */</span></span><br><span class="line">          <span class="keyword">const</span> <span class="title class_">Connect</span> = <span class="title class_">React</span>.<span class="title function_">memo</span>(<span class="title class_">ConnectFunction</span>) </span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">hoistStatics</span>(<span class="title class_">Connect</span>, <span class="title class_">WrappedComponent</span>)  <span class="comment">/* ç»§æ‰¿é™æ€å±æ€§ */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>connect çš„é€»è¾‘è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œæˆ‘æ€»ç»“ä¸€ä¸‹æ ¸å¿ƒæµç¨‹ã€‚</p>
<ul>
<li>1  connect ä¸­æœ‰ä¸€ä¸ª selector çš„æ¦‚å¿µï¼Œselector æœ‰ä»€ä¹ˆç”¨ï¼Ÿå°±æ˜¯é€šè¿‡ mapStateToProps ï¼ŒmapDispatchToProps ï¼ŒæŠŠ redux ä¸­ state çŠ¶æ€åˆå¹¶åˆ° props ä¸­ï¼Œå¾—åˆ°æœ€æ–°çš„ props ã€‚</li>
<li>2 ä¸Šè¿°è®²åˆ°è¿‡ï¼Œæ¯ä¸€ä¸ª connect éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ Subscription ï¼Œå’Œçˆ¶çº§è®¢é˜…å™¨å»ºç«‹èµ·å…³è”ï¼Œè¿™æ ·çˆ¶çº§ä¼šè§¦å‘å­ä»£çš„ Subscription æ¥å®ç°é€å±‚çš„çŠ¶æ€æ´¾å‘ã€‚</li>
<li>3 æœ‰ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå°±æ˜¯ Subscription é€šçŸ¥çš„æ˜¯ checkForUpdates å‡½æ•°ï¼ŒcheckForUpdates ä¼šå½¢æˆæ–°çš„ props ï¼Œä¸ä¹‹å‰ç¼“å­˜çš„ props è¿›è¡Œæµ…æ¯”è¾ƒï¼Œå¦‚æœä¸æƒ³ç­‰ï¼Œé‚£ä¹ˆè¯´æ˜ state å·²ç»å˜åŒ–äº†ï¼Œç›´æ¥è§¦å‘ä¸€ä¸ªuseReducer æ¥æ›´æ–°ç»„ä»¶ï¼Œä¸Šè¿°ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘ç”¨ useState ä»£æ›¿ useReducer äº†ï¼Œå¦‚æœç›¸ç­‰ï¼Œé‚£ä¹ˆå½“å‰ç»„ä»¶ä¸éœ€è¦æ›´æ–°ï¼Œç›´æ¥é€šçŸ¥å­ä»£ Subscription ï¼Œæ£€æŸ¥å­ä»£ Subscription æ˜¯å¦æ›´æ–°ï¼Œå®Œæˆæ•´ä¸ªæµç¨‹ã€‚</li>
</ul>
<h2 id="å››-å®ç°å¼‚æ­¥"><a href="#å››-å®ç°å¼‚æ­¥" class="headerlink" title="å›› å®ç°å¼‚æ­¥"></a>å›› å®ç°å¼‚æ­¥</h2><p>åŸºäº redux å¼‚æ­¥çš„åº“æœ‰å¾ˆå¤šï¼Œæœ€ç®€å•çš„ <code>redux-thunk</code> ï¼Œä»£ç é‡å°‘ï¼Œåªæœ‰å‡ è¡Œï¼Œå…¶ä¸­å¤§é‡çš„é€»è¾‘éœ€è¦å¼€å‘è€…å®ç°ï¼Œè¿˜æœ‰æ¯”è¾ƒå¤æ‚çš„ <code>redux-saga</code> ï¼ŒåŸºäº <code>generator</code> å®ç°ï¼Œç”¨èµ·æ¥ç¨å¾®ç¹çã€‚</p>
<p>å¯¹äºå®Œæ•´çš„çŠ¶æ€ç®¡ç†ç”Ÿæ€ï¼Œå¤§å®¶å¯ä»¥å°è¯•ä¸€ä¸‹ <code>dvajs</code> ï¼Œå®ƒæ˜¯åŸºäº redux-saga åŸºç¡€ä¸Šï¼Œå®ç°çš„å¼‚æ­¥çš„çŠ¶æ€ç®¡ç†å·¥å…·ã€‚dvajs å¤„ç† reducers ä¹Ÿæ¯”è¾ƒç²¾å¦™ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥ç ”ç©¶ä¸€ä¸‹ã€‚</p>
<h2 id="äº”-æ€»ç»“"><a href="#äº”-æ€»ç»“" class="headerlink" title="äº” æ€»ç»“"></a>äº” æ€»ç»“</h2><p>é€šè¿‡æœ¬ç« èŠ‚çš„å­¦ä¹ ï¼Œåº”è¯¥å·²ç»æŒæ¡ä¸€ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>1 Redux çš„åŸºæœ¬æ¦‚å¿µå’Œå¸¸ç”¨ API ã€‚</li>
<li>2 react-redux åŸºæœ¬ç”¨æ³•ï¼Œä»¥åŠä¸¤ç§å¸¸ç”¨åœºæ™¯çš„å®è·µ demo ã€‚</li>
<li>3 react-redux åŸç†å®ç°ã€‚</li>
</ul>
<p>ä¸‹ä¸€èŠ‚å°†å­¦ä¹  React çŠ¶æ€ç®¡ç†çš„å¦å¤–ä¸€ç§æ–¹å¼ Mobx ã€‚</p>
</div><div class="tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/book/tags/React/" rel="tag">React</a></li></ul></div><div class="post-nav"><a class="pre" href="/book/2023/chapter-22-ecology-react-router/">ç¬¬22ç« â€”ç”Ÿæ€ç¯‡-React-router</a><a class="next" href="/book/2023/chapter-24-ecology-react-mobx/">ç¬¬24ç« â€”ç”Ÿæ€ç¯‡-React-mobx</a></div><script src="https://utteranc.es/client.js" repo="Flashcard8009/book" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="å…³äº"><img class="nofancybox" src="https://avatars.githubusercontent.com/Flashcard8009"/></a><p>To be a better man.</p><a class="info-icon" href="https://github.com/Flashcard8009" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/username" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/book/categories/%E9%BB%98%E8%AE%A4/">é»˜è®¤</a><span class="category-list-count">42</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/book/tags/React/" style="font-size: 15px;">React</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-04-basic-chapter-metaphysics-state/">ç¬¬04ç« â€”åŸºç¡€ç¯‡-ç„å­¦state</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-05-basic-chapter-deep-tips/">ç¬¬05ç« â€”åŸºç¡€ç¯‡-æ·±å…¥props</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-06-basic-chapter-understanding-lifecycle/">ç¬¬06ç« â€”åŸºç¡€ç¯‡-ç†è§£lifeCycle</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-07-basic-chapter-multifunctional-ref/">ç¬¬07ç« â€”åŸºç¡€ç¯‡-å¤šåŠŸèƒ½Ref</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-08-basic-chapter-provider-context/">ç¬¬08ç« â€”åŸºç¡€ç¯‡-æä¾›è€…context</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-09-fundamentals-modular-css/">ç¬¬09ç« â€”åŸºç¡€ç¯‡-æ¨¡å—åŒ–css</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-10-fundamentals-advanced-components/">ç¬¬10ç« â€”åŸºç¡€ç¯‡-é«˜é˜¶ç»„ä»¶</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-11-optimization-rendering-control/">ç¬¬11ç« â€”ä¼˜åŒ–ç¯‡-æ¸²æŸ“æ§åˆ¶</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-12-optimization-chapter-rendering-tuning/">ç¬¬12ç« â€”ä¼˜åŒ–ç¯‡-æ¸²æŸ“è°ƒä¼˜</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-13-optimization-processing-massive-data/">ç¬¬13ç« â€”ä¼˜åŒ–ç¯‡-å¤„ç†æµ·é‡æ•°æ®</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="/" title="ä¸­æ–‡åšå®¢" target="_blank">ä¸­æ–‡åšå®¢</a><ul></ul><a href="/en" title="EN Blog" target="_blank">EN Blog</a><ul></ul><a href="https://github.com/Flashcard8009" title="GitHub" target="_blank">GitHub</a><ul></ul><a href="https://www.baidu.com/" title="ç™¾åº¦" target="_blank">ç™¾åº¦</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2023 <a href="/book/." rel="nofollow">æ˜é‡‘å°å†Œ.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/book/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/book/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/book/css/search.css?v=1.0.0"><script type="text/javascript" src="/book/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/book/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/book/js/copycode.js?v=1.0.0" successtext="å¤åˆ¶æˆåŠŸï¼"></script><link rel="stylesheet" type="text/css" href="/book/css/copycode.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="/book/css/external.css?v=1.0.0"><script type="text/javascript" src="/book/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/book/js/smartresize.js?v=1.0.0"></script></div></body></html>