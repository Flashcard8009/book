<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>ç¬¬31ç« â€”åŸç†ç¯‡-ContextåŸç† | æ˜é‡‘å°å†Œ</title><link rel="stylesheet" type="text/css" href="/book/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/book/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/book/favicon.ico"><link rel="apple-touch-icon" href="/book/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/book/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/book/atom.xml"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ç¬¬31ç« â€”åŸç†ç¯‡-ContextåŸç†</h1><a id="logo" href="/book/.">æ˜é‡‘å°å†Œ</a><p class="description">å­¦æµ·æ— æ¶¯ï¼Œå…±åŒè¿›æ­¥ï¼</p></div><div id="nav-menu"><a class="current" href="/book/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/book/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/book/about/"><i class="fa fa-user"> å…³äº</i></a><a href="/book/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a><a href="/book/guestbook/"><i class="fa fa-comments"> ç•™è¨€</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">ç¬¬31ç« â€”åŸç†ç¯‡-ContextåŸç†</h1><div class="post-meta">2023-09-26<span> | </span><span class="category"><a href="/book/categories/%E9%BB%98%E8%AE%A4/">é»˜è®¤</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 4.2k</span><span class="post-meta-item-text"> å­—</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 16</span><span class="post-meta-item-text"> åˆ†é’Ÿ</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">æ–‡ç« ç›®å½•</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-context-%E5%AF%B9%E8%B1%A1"><span class="toc-text">1 context å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#context-%E5%AF%B9%E8%B1%A1"><span class="toc-text">context å¯¹è±¡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Provider-%E6%8F%90%E4%BE%9B%E8%80%85"><span class="toc-text">Provider æä¾›è€…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Provider-%E5%92%8C-beiginWork-%E8%B0%83%E5%92%8C%E6%9B%B4%E6%96%B0%E6%9C%BA%E5%88%B6"><span class="toc-text">Provider å’Œ beiginWork è°ƒå’Œæ›´æ–°æœºåˆ¶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Consumer"><span class="toc-text">2 Consumer</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Consumer-%E6%B5%81%E7%A8%8B"><span class="toc-text">Consumer æµç¨‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#readContext"><span class="toc-text">readContext</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA-Provider-%E5%B5%8C%E5%A5%97"><span class="toc-text">å¤šä¸ª Provider åµŒå¥—</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-contextType-%E5%92%8C-useContext"><span class="toc-text">3 contextType å’Œ useContext</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#useContext-%E5%8E%9F%E7%90%86"><span class="toc-text">useContext åŸç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#contextType-%E5%8E%9F%E7%90%86"><span class="toc-text">contextType åŸç†</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Context-%E6%B5%81%E7%A8%8B%E6%80%BB%E7%BB%93"><span class="toc-text">4 Context æµç¨‹æ€»ç»“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%80%BB%E7%BB%93"><span class="toc-text">5 æ€»ç»“</span></a></li></ol></div></div><div class="post-content"><p>æ¥ä¸‹æ¥å°†ä»‹ç» <code>context</code> åŸç†ã€‚é‡ç‚¹æµç¨‹æ”¾åœ¨ context çš„<strong>ä¼ é€’</strong>å’Œ<strong>æ›´æ–°</strong>ä¸¤ä¸ªæ–¹é¢ã€‚å¯¹äºåŸç†éƒ¨åˆ†ï¼Œæˆ‘åœ¨è¿™é‡Œåªä»‹ç»äº†æ–°ç‰ˆæœ¬ Context çš„åŸç†ã€‚æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥çœ‹ä¸€ä¸‹æºç ã€‚</p>
<p>ä»¥ <code>React 16.8</code> ä¸ºä¾‹å­ğŸŒ°ï¼š</p>
<ul>
<li>æ–°ç‰ˆæœ¬ Context ä½ç½®ï¼š<code>react-reconciler/src/ReactFiberNewContext.js</code></li>
<li>è€ç‰ˆæœ¬ Context ä½ç½®ï¼š<code>react-reconciler/src/ReactFiberContext.js</code></li>
</ul>
<p>å¸Œæœ›å¤§å®¶å¸¦ç€è¿™äº›é—®é¢˜å»é˜…è¯»</p>
<ul>
<li>1 Provder å¦‚ä½•ä¼ é€’ contextï¼Ÿ</li>
<li>2 ä¸‰ç§è·å– context åŸç† ï¼ˆ <code>Consumer</code>ï¼Œ <code>useContext</code>ï¼Œ<code>contextType</code> ï¼‰ï¼Ÿ</li>
<li>3 æ¶ˆè´¹ <code>context</code> çš„ç»„ä»¶ï¼Œcontext æ”¹å˜ï¼Œä¸ºä»€ä¹ˆä¼šè®¢é˜…æ›´æ–° ï¼ˆå¦‚ä½•å®ç°ï¼‰ ã€‚</li>
<li>4 context æ›´æ–°ï¼Œå¦‚ä½•é¿å… <code>pureComponent</code> ï¼Œ <code>shouldComponentUpdate</code> æ¸²æŸ“æ§åˆ¶ç­–ç•¥çš„å½±å“ã€‚</li>
<li>5 å¦‚ä½•å®ç°çš„ context åµŒå¥—ä¼ é€’ ï¼ˆ å¤šä¸ª Povider ï¼‰?</li>
</ul>
<h3 id="1-context-å¯¹è±¡"><a href="#1-context-å¯¹è±¡" class="headerlink" title="1 context å¯¹è±¡"></a>1 context å¯¹è±¡</h3><p>ä¸Šè¿°æ‰€è¯´çš„è€ç‰ˆæœ¬ context å°±æ˜¯ Legacy Context æ¨¡å¼ä¸‹çš„ context ï¼Œè€ç‰ˆæœ¬çš„ context æ˜¯é‡‡ç”¨çº¦å®šå¼çš„ä½¿ç”¨è§„åˆ™ï¼Œäºæ˜¯æœ‰äº† <code>getChildContext</code> å’Œ <code>childContextTypes</code> åå•†çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™ç§æ–¹å¼ä¸ä»…ä¸å¤Ÿçµæ´»ï¼Œè€Œä¸”å¯¹äºå‡½æ•°ç»„ä»¶ä¹Ÿå­˜åœ¨å±€é™æ€§ï¼Œæ‰€ä»¥åœ¨ <code>v16.3</code> æ¨å‡ºäº†æ–°ç‰ˆæœ¬çš„ <code>context</code>ï¼Œå¼€å‘è€…èƒ½å¤Ÿæ›´åŠ çµæ´»çš„è¿ç”¨ Contextã€‚æ–°ç‰ˆæœ¬å¼•å…¥ context å¯¹è±¡çš„æ¦‚å¿µï¼Œè€Œä¸” context å¯¹è±¡ä¸Šé™¤äº†ä¿ç•™äº†ä¼ é€’çš„ä¿¡æ¯ <code>value</code> å¤– ï¼Œ è¿˜æœ‰æä¾›è€… <code>Provder</code> å’Œæ¶ˆè´¹è€… <code>Consumer</code>ã€‚</p>
<h4 id="context-å¯¹è±¡"><a href="#context-å¯¹è±¡" class="headerlink" title="context å¯¹è±¡"></a>context å¯¹è±¡</h4><p>è¦æƒ³åƒé€ context ï¼Œé¦–å…ˆè¦ç ”ç©¶ä¸€ä¸‹ Context å¯¹è±¡æ˜¯ä»€ä¹ˆã€‚ä¸Šè¿°è®²åˆ°å¯ä»¥é€šè¿‡ <code>createContext</code> åˆ›å»ºä¸€ä¸ª context ã€‚é‚£ä¹ˆä¸‡ç‰©ä¹‹æºå°±æ˜¯è¿™ä¸ª API ï¼Œæ¥ä¸‹æ¥ä¸€èµ·æ­å¼€ context å¯¹è±¡é¢çº±ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">createContext</span>(<span class="params">defaultValue,calculateChangedBits</span>)&#123;</span><br><span class="line">   <span class="comment">/* context å¯¹è±¡æœ¬è´¨  */</span> </span><br><span class="line">  <span class="keyword">const</span> context  = &#123;</span><br><span class="line">        <span class="attr">$$typeof</span>: <span class="variable constant_">REACT_CONTEXT_TYPE</span>, <span class="comment">/* æœ¬è´¨ä¸Šå°±æ˜¯ Consumer element ç±»å‹ */</span></span><br><span class="line">        <span class="attr">_calculateChangedBits</span>: calculateChangedBits,</span><br><span class="line">        <span class="attr">_currentValue</span>: defaultValue,</span><br><span class="line">        <span class="attr">_threadCount</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="title class_">Provider</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="title class_">Consumer</span>: <span class="literal">null</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/* æœ¬è´¨ä¸Šå°±æ˜¯ Provider element ç±»å‹ã€‚  */</span></span><br><span class="line">  context.<span class="property">Provider</span> = &#123;</span><br><span class="line">    <span class="attr">$$typeof</span>: <span class="variable constant_">REACT_PROVIDER_TYPE</span>,</span><br><span class="line">    <span class="attr">_context</span>: context,</span><br><span class="line">  &#125;;</span><br><span class="line">  context.<span class="property">Consumer</span> = context </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šå¯ä»¥å¾ˆå®¹æ˜“çš„çœ‹æ¸…æ¥š context å¯¹è±¡çš„æœ¬è´¨ï¼Œè¿™é‡Œé‡ç‚¹ä»‹ç»ä¸‰ä¸ªå±æ€§</p>
<ul>
<li><strong><code>Provider</code></strong> æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª element å¯¹è±¡ $$typeof -&gt; <code>REACT_PROVIDER_TYPE</code></li>
<li><strong><code>Consumer</code></strong> æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ª element å¯¹è±¡ $$typeof -&gt; <code>REACT_CONTEXT_TYPE</code></li>
<li><strong><code>_currentValue</code></strong> è¿™ä¸ªç”¨æ¥ä¿å­˜ä¼ é€’ç»™  Provider çš„ value ã€‚</li>
</ul>
<h4 id="Provider-æä¾›è€…"><a href="#Provider-æä¾›è€…" class="headerlink" title="Provider æä¾›è€…"></a>Provider æä¾›è€…</h4><p>ä¸Šè¿°æ˜ç™½äº† Provider æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ React Element å¯¹è±¡ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥é‡ç‚¹çœ‹ä¸€ä¸‹ Provider çš„å®ç°åŸç†ï¼Œç ”ç©¶ Provider é‡ç‚¹å›´ç»•è¿™ä¸¤ä¸ªç‚¹ã€‚</p>
<ul>
<li>Provider å¦‚ä½•ä¼ é€’ context çŠ¶æ€çš„ã€‚</li>
<li>Provider ä¸­ value æ”¹å˜ï¼Œå¦‚ä½•é€šçŸ¥è®¢é˜… contextã€‚</li>
</ul>
<p>ä¹‹å‰çš„ç« èŠ‚è®²è¿°äº† <strong>jsx -&gt; element -&gt; fiber</strong> çš„æµç¨‹ï¼ŒæŒ‰ç…§è¿™ä¸ªé€»è¾‘ï¼Œæ¥ä¸‹æ¥çœ‹ä¸€ä¸‹ Provdier çš„å¤„ç†ã€‚</p>
<ul>
<li>é¦–å…ˆæ ‡ç­¾å½¢å¼çš„ <code>&lt;Provider&gt;</code> æœ¬è´¨ä¸Šå°±æ˜¯ <code>REACT_PROVIDER_TYPE</code> çš„ React Element ã€‚<code>&lt;Provider&gt;</code> -&gt; <code>REACT_PROVIDER_TYPE</code> React element ã€‚</li>
<li>æ¥ä¸‹æ¥ element ä¼šè½¬åŒ–æˆ fiber ï¼Œfiber ç±»å‹ä¸º <strong>ContextProvider</strong> ï¼Œ React element -&gt;  <code>ContextProvide fiber</code>ã€‚</li>
</ul>
<p>ContextProvider ç±»å‹çš„ fiber ï¼Œåœ¨ fiber è°ƒå’Œé˜¶æ®µä¼šè¿›å…¥åˆ° <code>beginWork</code> æµç¨‹ï¼Œè¿™ä¸ªé˜¶æ®µä¼šå‘ç”Ÿä¸¤ä»¶äº‹ã€‚</p>
<ul>
<li>å¦‚æœå½“å‰ç±»å‹çš„ fiber ä¸éœ€è¦æ›´æ–°ï¼Œé‚£ä¹ˆä¼š <code>FinishedWork</code> ä¸­æ­¢å½“å‰èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹çš„æ›´æ–°ã€‚</li>
<li>å¦‚æœå½“å‰ç±»å‹ fiber éœ€è¦æ›´æ–°ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨ä¸åŒç±»å‹ fiber çš„å¤„ç†æ–¹æ³•ã€‚å½“ç„¶ <code>ContextProvider</code> ä¹Ÿæœ‰ç‰¹æœ‰çš„ fiber æ›´æ–°æ–¹æ³• â€”â€” <code>updateContextProvider</code>ï¼Œé‚£ä¹ˆå¦‚æœæƒ³è¦æ·±å…¥ <code>Provder</code> çš„å¥¥ç§˜ï¼Œæœ‰å¿…è¦çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•åšäº†äº›ä»€ä¹ˆï¼Ÿ</li>
</ul>
<blockquote>
<p>react-reconciler&#x2F;src&#x2F;ReactFiberBeginWork.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">updateContextProvider</span>(<span class="params">current ,workInProgress,renderExpirationTime,</span>) &#123;</span><br><span class="line">  <span class="comment">/*  è·å– Provder ä¸Šçš„ value  */</span></span><br><span class="line">  <span class="title function_">pushProvider</span>(workInProgress, newProps.<span class="property">value</span>;);</span><br><span class="line">  <span class="comment">/* æ›´æ–° context  */</span></span><br><span class="line">  <span class="keyword">if</span> (oldProps !== <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> changedBits = <span class="title function_">calculateChangedBits</span>(context, newProps.<span class="property">value</span>;, oldProps.<span class="property">value</span>);</span><br><span class="line">    <span class="keyword">if</span> (changedBits === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">//context æ²¡æœ‰å˜åŒ–ã€‚å¦‚æœå­©å­ä»¬éƒ½æ˜¯ä¸€æ ·çš„è¯ã€‚é‚£ä¹ˆä¸éœ€è¦æ›´æ–°</span></span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        oldProps.<span class="property">children</span> === newProps.<span class="property">children</span> &amp;&amp;</span><br><span class="line">        !<span class="title function_">hasLegacyContextChanged</span>() </span><br><span class="line">      ) &#123;</span><br><span class="line">         <span class="keyword">return</span> ...  <span class="comment">// åœæ­¢è°ƒåˆå­èŠ‚ç‚¹,æ”¶å°¾å·¥ä½œ</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">/* context æ”¹å˜ï¼Œæ›´æ–° context */</span></span><br><span class="line">      <span class="title function_">propagateContextChange</span>( workInProgress,context, changedBits, renderExpirationTime,);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* ç»§ç»­å‘ä¸‹è°ƒå’Œå­ä»£ fiber  */</span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šä¿ç•™äº† <code>updateContextProvider</code> çš„æ ¸å¿ƒæµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>ç¬¬ä¸€æ­¥ï¼š é¦–å…ˆä¼šè°ƒç”¨ <code>pushProvider</code>ï¼Œ<code>pushProvider</code> ä¼šè·å– type å±æ€§ä¸Šçš„ _context å¯¹è±¡ï¼Œå°±æ˜¯ä¸Šè¿°é€šè¿‡ <code>createContext</code> åˆ›å»ºçš„ context å¯¹è±¡ã€‚ç„¶åå°† Provider çš„ value å±æ€§ï¼Œèµ‹å€¼ç»™ context çš„ _currentValue å±æ€§ä¸Šã€‚<strong>è¿™é‡Œè§£é‡Šäº† Provder é€šè¿‡ä»€ä¹ˆæ‰‹æ®µä¼ é€’ context valueï¼Œå³é€šè¿‡æŒ‚è½½ context çš„ _currentValue å±æ€§ã€‚</strong></p>
</li>
<li><p>ç¬¬äºŒæ­¥ï¼š é€šè¿‡ <code>calculateChangedBits</code> è®¡ç®—å‡º changedBits ï¼Œ<code>calculateChangedBits</code> å†…éƒ¨è§¦å‘ context å¯¹è±¡ä¸Šçš„ <code>_calculateChangedBits</code> ï¼Œç»†å¿ƒçš„åŒå­¦å¯ä»¥å‘ç°ï¼Œåœ¨è°ƒç”¨ <code>createContext</code> çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯æœ‰ç¬¬äºŒä¸ªå‚æ•°çš„ <code>calculateChangedBits</code>ï¼Œåœ¨æ›´æ–° Provider çš„æ—¶å€™è¿™ä¸ªå‚æ•°å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œå½“å®ƒè¿”å›çš„ <code>changedBits === 0</code> çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿˜ä¼šæµ…æ¯”è¾ƒ children æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œè¿˜æœ‰å°±æ˜¯æœ‰æ²¡æœ‰ <code>legacy context</code>ï¼Œå¦‚æœè¿™ä¸‰ç‚¹éƒ½æ»¡è¶³çš„è¯ï¼Œé‚£ä¹ˆä¼šåˆ¤æ–­å½“å‰ Provider å’Œå­èŠ‚ç‚¹ä¸éœ€è¦æ›´æ–°ï¼Œé‚£ä¹ˆä¼š return åœæ­¢å‘ä¸‹è°ƒå’Œå­èŠ‚ç‚¹ã€‚</p>
</li>
<li><p>ç¬¬ä¸‰æ­¥ï¼ˆ<strong>é‡ç‚¹</strong>ï¼‰ï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œç»å¤§å¤šæ•°å½“ value å‘ç”Ÿå˜åŒ–ï¼Œä¼šèµ° <code>propagateContextChange</code> è¿™ä¸ªæµç¨‹ï¼Œä¹Ÿæ˜¯ Provider æ›´æ–°çš„ç‰¹ç‚¹ã€‚é‚£ä¹ˆè¿™ä¸ªæ–¹æ³•åˆ°åº•åšäº†äº›ä»€ä¹ˆå‘¢ï¼Ÿæ¥ä¸‹æ¥é‡ç‚¹çœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°åšäº†äº›ä»€ä¹ˆï¼Ÿ</p>
</li>
</ul>
<p><strong>propagateContextChange</strong> å‡½æ•°æµç¨‹å¾ˆç¹çï¼Œè¿™é‡Œç®€åŒ–äº†æµç¨‹ï¼Œä¿ç•™äº†æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">propagateContextChange</span>(<span class="params">workInProgress,context</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> fiber = workInProgress.<span class="property">child</span>;</span><br><span class="line">    <span class="keyword">if</span> (fiber !== <span class="literal">null</span>) &#123;</span><br><span class="line">        fiber.<span class="property">return</span> = workInProgress;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(fiber !== <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> list = fiber.<span class="property">dependencies</span>;</span><br><span class="line">         <span class="keyword">while</span> (dependency !== <span class="literal">null</span>) &#123;</span><br><span class="line">              <span class="keyword">if</span> (dependency.<span class="property">context</span> === context)&#123;</span><br><span class="line">                   <span class="comment">/* ç±»ç»„ä»¶ï¼šä¸å— PureComponent å’Œ shouldComponentUpdate å½±å“ */</span></span><br><span class="line">                   <span class="keyword">if</span> (fiber.<span class="property">tag</span> === <span class="title class_">ClassComponent</span>) &#123;</span><br><span class="line">                         <span class="comment">/* ä¼šèµ° forceUpdate é€»è¾‘ */</span></span><br><span class="line">                        <span class="keyword">const</span> update = <span class="title function_">createUpdate</span>(renderExpirationTime, <span class="literal">null</span>);</span><br><span class="line">                        update.<span class="property">tag</span> = <span class="title class_">ForceUpdate</span>;</span><br><span class="line">                        <span class="title function_">enqueueUpdate</span>(fiber, update);</span><br><span class="line">                   &#125;</span><br><span class="line">                   <span class="comment">/* é‡è¦ï¼š<span class="doctag">TODO:</span> æé«˜ fiber çš„ä¼˜å…ˆçº§ï¼Œè®©å½“å‰ fiber å¯ä»¥ beginWork ï¼Œå¹¶ä¸”å‘ä¸Šæ›´æ–°çˆ¶çº§ fiber é“¾ä¸Šçš„ä¼˜å…ˆçº§ */</span></span><br><span class="line">                   ...</span><br><span class="line">              &#125; </span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> <code>propagateContextChange</code> éå¸¸é‡è¦ï¼Œå®ƒçš„èŒè´£å°±æ˜¯æ·±åº¦éå†æ‰€æœ‰çš„å­ä»£ fiber ï¼Œç„¶åæ‰¾åˆ°é‡Œé¢å…·æœ‰ <code>dependencies</code> çš„å±æ€§ï¼Œå¯¹æ¯” dependencies ä¸­çš„ context å’Œå½“å‰ Provider çš„ context æ˜¯å¦æ˜¯åŒä¸€ä¸ªï¼Œå¦‚æœæ˜¯åŒä¸€ä¸ªï¼Œé‚£ä¹ˆå¦‚æœå½“å‰ fiber æ˜¯ç±»ç»„ä»¶ï¼Œé‚£ä¹ˆä¼šç»™ç»‘å®šä¸€ä¸ª forceUpdate æ ‡è¯† ã€‚ç„¶åä¼šæé«˜  fiber çš„æ›´æ–°ä¼˜å…ˆçº§ï¼Œè®© fiber åœ¨æ¥ä¸‹æ¥çš„è°ƒå’Œè¿‡ç¨‹ä¸­ï¼Œå¤„äºä¸€ä¸ªé«˜ä¼˜å…ˆçº§å¾…æ›´æ–°çš„çŠ¶æ€ã€‚æ¥ä¸‹æ¥çš„ä»£ç æ¯”è¾ƒé•¿ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰å…¨éƒ¨ç½—åˆ—å‡ºæ¥ï¼Œå¤§è‡´é€»è¾‘å°±æ˜¯ï¼Œæ‰¾åˆ°å½“å‰ fiber å‘ä¸Šçš„çˆ¶çº§é“¾ä¸Šçš„ fiber ï¼Œç»Ÿä¸€æ›´æ–°ä»–ä»¬çš„ä¼˜å…ˆçº§ï¼Œä½¿ä¹‹å˜æˆé«˜ä¼˜å…ˆçº§å¾…æ›´æ–°çŠ¶æ€ã€‚</p>
<p>é‚£ä¹ˆä¸Šè¿°æµç¨‹ä¸­æš´éœ²å‡ºå‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li><p>1 ä»€ä¹ˆæƒ…å†µä¸‹ fiber ä¼šå­˜åœ¨ dependencies ï¼Œé¦–å…ˆ dependencies åœ¨ç¬¬åä¸ƒç« ä¸­ä¼šè®²åˆ°ï¼Œå®ƒä¿å­˜çš„æ˜¯ context çš„ä¾èµ–é¡¹ï¼Œé‚£ä¹ˆä»€ä¹ˆæƒ…å†µä¸‹ä¼šå­˜åœ¨ <strong>context ä¾èµ–é¡¹</strong>ã€‚</p>
</li>
<li><p>2 ä¸ºä»€ä¹ˆå¯¹äº class ç±»ç»„ä»¶ä¼šåˆ›å»ºä¸€ä¸ª ForceUpdate ç±»å‹çš„ update å¯¹è±¡å‘¢ï¼Ÿ <br/> çŸ¥å…¶ç„¶ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</p>
</li>
</ul>
<p><strong>ï½œâ€”â€”â€“é—®ä¸ç­”â€”â€”â€“ï½œ</strong><br/></p>
<p>é—®ï¼š <strong>ForceUpdate ç±»å‹ update</strong>ï¼š ä»€ä¹ˆæ˜¯ forceUpdate ç±»å‹çš„ update å‘¢ï¼Ÿ </p>
<p>ç­”ï¼šåœ¨ç±»ç»„ä»¶ä¸­ï¼Œé€šè¿‡è°ƒç”¨ <code>this.forceUpdate()</code> å¸¦æ¥çš„æ›´æ–°å°±ä¼šè¢«æ‰“ä¸Š ForceUpdate ç±»å‹çš„ update tagï¼Œè¿™é‡Œå¯ä»¥ç†è§£ä¸ºå¼ºåˆ¶æ›´æ–°ã€‚ ç”Ÿå‘½å‘¨æœŸç« èŠ‚è®²è¿‡ï¼Œ åœ¨ç±»ç»„ä»¶æ›´æ–°æµç¨‹ä¸­ï¼Œå¼ºåˆ¶æ›´æ–°ä¼šè·³è¿‡ <code>PureComponent</code> å’Œ <code>shouldComponentUpdate</code> ç­‰ä¼˜åŒ–ç­–ç•¥ã€‚<br><strong>ï½œâ€”â€”â€”endâ€”â€”â€”ï½œ</strong></p>
<ul>
<li>3 å­˜åœ¨ dependency çš„ fiber ï¼Œä¸ºä»€ä¹ˆè¦å‘ä¸Šæ›´æ–°çˆ¶çº§ fiber é“¾ä¸Šçš„ä¼˜å…ˆçº§ï¼Œè®©æ‰€æœ‰çˆ¶çº§ fiber éƒ½å¤„äºä¸€ä¸ªé«˜ä¼˜å…ˆçº§ã€‚</li>
</ul>
<p>å¯¹äºä¸Šé¢è¿™ä¸‰ä¸ªé—®é¢˜ï¼Œè·Ÿä¸Šæˆ‘çš„æ€è·¯é€ä¸€çªç ´ã€‚</p>
<p><strong>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼š</strong><br>é¦–å…ˆå°±æ˜¯ dependencies å±æ€§ï¼Œè¿™ä¸ªå±æ€§å¯ä»¥æŠŠå½“å‰çš„ fiber å’Œ context å»ºç«‹èµ·å…³è”ï¼Œé‚£ä¹ˆå¯ä»¥ç†è§£æˆï¼Œä½¿ç”¨äº†å½“å‰ context çš„ fiber ä¼šæŠŠ context æ”¾åœ¨ dependencies ä¸­ï¼Œdependencies å±æ€§æœ¬èº«æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„ï¼Œä¸€ä¸ª fiber å¯ä»¥æœ‰å¤šä¸ª context ä¸ä¹‹å¯¹åº”ã€‚åè¿‡æ¥æ¨æµ‹ä¸€ä¸‹ï¼Œä»€ä¹ˆæƒ…å†µä¸‹ä¼šä½¿ç”¨ context å‘¢ã€‚é‚£ä¹ˆæœ‰ä»¥ä¸‹å‡ ç§å¯èƒ½ï¼š</p>
<p>1 æœ‰ <code>contextType</code> é™æ€å±æ€§æŒ‡å‘çš„ç±»ç»„ä»¶ã€‚<br /><br>2 ä½¿ç”¨ <code>useContext</code> hooks çš„å‡½æ•°ç»„ä»¶ã€‚ <br /><br>3 context æä¾›çš„ <code>Consumer</code>ã€‚   </p>
<p>é‚£ä¹ˆå¯ä»¥å¤§èƒ†çš„æ¨æµ‹ä¸€ä¸‹ï¼Œ<strong>ä½¿ç”¨è¿‡ contextType useContext çš„ç»„ä»¶å¯¹åº” fiber,å’Œ Consumer ç±»å‹ fiberï¼Œä¼šå’Œ dependencies å»ºç«‹èµ·è”ç³»ï¼Œä¼šæŠŠå½“å‰æ¶ˆè´¹çš„ context æ”¾å…¥ dependencies ä¸­ã€‚è¿™ä¸ªä¸‹é¢ä¼šç»™è¯¦ç»†è§£é‡Š</strong>  </p>
<p><strong>ç¬¬äºŒä¸ªé—®é¢˜ï¼š</strong><br>ä¸ºä»€ä¹ˆå¯¹äº class ç»„ä»¶ä¼šåˆ›å»ºä¸€ä¸ª ForceUpdate çš„ update å‘¢ï¼Ÿ </p>
<p>åœ¨<strong>ç”Ÿå‘½å‘¨æœŸç« èŠ‚</strong>å’Œ<strong>æ¸²æŸ“æ§åˆ¶ç« èŠ‚</strong>ï¼Œè®²åˆ°è¿‡å¦‚æœæƒ³è¦è®©ç±»ç»„ä»¶è°ƒç”¨ renderï¼Œå¾—åˆ°æ–°çš„ childrenï¼Œé‚£ä¹ˆå°±è¦é€šè¿‡ <code>PureComponent</code> å’Œ <code>shouldComponentUpdate</code> ç­‰å±‚å±‚é˜»ç¢ï¼Œé‚£ä¹ˆ context è¦çªç ´è¿™äº›æ§åˆ¶ï¼Œå°±è¦åšåˆ°å½“ value æ”¹å˜ï¼Œæ¶ˆè´¹ context çš„ç±»ç»„ä»¶æ›´æ–°ï¼Œåˆ™éœ€è¦é€šè¿‡ forceUpdate å¼ºåˆ¶æ›´æ–°ã€‚è¿™æ ·å°±è§£å†³äº†ç±»ç»„ä»¶æ›´æ–°é™åˆ¶ã€‚</p>
<p>é‚£ä¹ˆæ€»ç»“ä¸€ä¸‹æµç¨‹ï¼Œå½“ Provider çš„ value æ›´æ–°ä¹‹åï¼ŒProvider ä¸‹é¢çš„åªè¦æœ‰æ¶ˆè´¹äº† context çš„ç±»ç»„ä»¶ï¼Œå°±ä¼šè§¦å‘å¼ºåˆ¶æ›´æ–°ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†æœ€å¼€å§‹çš„é—®é¢˜â€”â€”<strong>context æ›´æ–°ï¼Œå¦‚ä½•é¿å… <code>pureComponent</code> ï¼Œ <code>shouldComponentUpdate</code> æ¸²æŸ“æ§åˆ¶ç­–ç•¥çš„å½±å“ã€‚</strong> ç”¨ä¸€å¹…æµç¨‹å›¾è¡¨ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261728771.jpeg" alt="context7.jpg"></p>
<p><strong>ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼š</strong> è¿™ä¸ªé—®é¢˜å°±è¦ä» Provider ç±»å‹çš„ fiber è°ƒå’Œå¼€å§‹è®²ã€‚</p>
<h4 id="Provider-å’Œ-beiginWork-è°ƒå’Œæ›´æ–°æœºåˆ¶"><a href="#Provider-å’Œ-beiginWork-è°ƒå’Œæ›´æ–°æœºåˆ¶" class="headerlink" title="Provider å’Œ beiginWork è°ƒå’Œæ›´æ–°æœºåˆ¶"></a>Provider å’Œ beiginWork è°ƒå’Œæ›´æ–°æœºåˆ¶</h4><p>æ¥ä¸‹æ¥é‡ç‚¹ä»‹ç» Provider å’Œ beiginWork è°ƒå’Œæ›´æ–°æœºåˆ¶ã€‚é¦–å…ˆå¼•å‡ºä¸¤ä¸ªæ€è€ƒç‚¹ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªç±»ç»„ä»¶æ‰§è¡Œ render ï¼Œå‡½æ•°ç»„ä»¶æ‰§è¡Œå°±æ˜¯æ¸²æŸ“ä¹ˆï¼Ÿ</li>
<li>ç¬¬äºŒä¸ª Context æ”¹å˜å¦‚ä½•åšåˆ°æ¶ˆè´¹ context çš„ç»„ä»¶æ›´æ–°çš„ï¼Ÿï¼ˆæ›´æ–°åŸç†ï¼‰</li>
</ul>
<p>å…ˆæ¥çœ‹ä¸€ä¸‹ç¬¬ä¸€ä¸ªæ€è€ƒç‚¹ï¼Œå…³äºæ¸²æŸ“çš„æ€è€ƒï¼Œå®é™…ä¸Šåœ¨ React æ•´ä¸ª <code>Reconciler</code> è°ƒå’Œæµç¨‹ä¸­ï¼Œä»æ›´æ–°è°ƒåº¦ä»»åŠ¡çš„å‘èµ·ï¼Œå†åˆ°åœ¨ commit å’Œ render ä¸¤å¤§é˜¶æ®µï¼Œå†åˆ°çœŸå®çš„ dom å…ƒç´ ç»˜åˆ¶ï¼Œæ¯ä¸€ä¸ªç¯èŠ‚éƒ½å±äºæ¸²æŸ“çš„ä¸€éƒ¨åˆ†ã€‚è€Œå¼€å‘è€…èƒ½å¤Ÿæ§åˆ¶çš„ render ï¼Œåªæ˜¯å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†â€”â€”ç±»ç»„ä»¶æ‰§è¡Œ render ï¼Œå‡½æ•°ç»„ä»¶æ‰§è¡Œã€‚è€Œä¸”è¿™äº›æœ¬è´¨ä¸Šéƒ½å‘ç”Ÿåœ¨ FunctionComponent fiber å’Œ ClassComponent fiber ä¸Šã€‚ä½†æ˜¯æ•´ä¸ª fiber æ ‘åœ¨è°ƒå’Œé˜¶æ®µéƒ½éœ€è¦æ›´æ–°çš„ã€‚æ›´æ–°è°ƒå’Œ fiber çš„æ–¹æ³•åœ¨ React åº•å±‚å«åš **<code>beginWork</code>**ã€‚æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼Œå°±æ˜¯ <code>beginWork</code> é renderã€‚å…ˆæ¥çœ‹çœ‹ä¸¤è€…çš„åŒºåˆ«ã€‚</p>
<ul>
<li><code>beginWork</code> ï¼š åœ¨ä¸€æ¬¡æ›´æ–°ä¸­ï¼Œåªè¦éœ€è¦æ›´æ–°çš„ fiber æˆ–è€…å—åˆ°ç‰µè¿çš„ fiberï¼Œéƒ½ä¼šæ‰§è¡Œ beginWork ã€‚</li>
<li><code>render</code>   ï¼š åœ¨ä¸€æ¬¡æ›´æ–°ä¸­ï¼Œåªæœ‰ç»„ä»¶ç±»å‹çš„ fiber ä¼šæ‰§è¡Œ render ï¼Œå¾—åˆ°æ–°çš„ children ã€‚å¦‚æœç»„ä»¶è§¦å‘ render é‚£ä¹ˆå®ƒä¸€å®šç»å†è¿‡ <code>beginWork</code></li>
</ul>
<p>è¿™é‡Œå¦‚æœæœ‰åŒå­¦ä¸æ˜ç™½ä¸è¦ç´§ï¼Œæ¥ç€å¾€ä¸‹çœ‹ã€‚</p>
<p>æ¯”å¦‚å‘ç”Ÿä¸€æ¬¡æ›´æ–°ä»»åŠ¡ï¼Œæ­¤æ¬¡æ›´æ–°å¯èƒ½å‘ç”Ÿæ•´ä¸ª fiber æ ‘çš„ä»»æ„æå¶ä¸Šï¼Œä½†æ˜¯å› ä¸º context props ç©¿é€å½±å“ï¼ŒReact ä¸çŸ¥é“æ­¤æ¬¡æ›´æ–°çš„æ³¢åŠèŒƒå›´ï¼Œé‚£ä¹ˆå¦‚ä½•å¤„ç†å‘¢ï¼Ÿ React ä¼šä» rootFiber å¼€å§‹æ›´æ–°ï¼Œæ¯ä¸€ä¸ªæ›´æ–° fiber éƒ½ä¼šèµ° <code>beginWork</code> æµç¨‹ï¼Œå¼€å§‹æ‰¾ä¸åŒï¼Œæ‰¾åˆ°æœ‰æ²¡æœ‰éœ€è¦æ›´æ–°çš„åœ°æ–¹ï¼Œé‚£ä¹ˆæŒ‡æ ‡æ˜¯ä»€ä¹ˆå‘¢ï¼Œå…¶ä¸­ä¸€ä¸ªé‡è¦çš„æŒ‡æ ‡å°±æ˜¯<strong>æ›´æ–°çš„ä¼˜å…ˆçº§</strong>ï¼Œè€ç‰ˆæœ¬ç”¨çš„æ˜¯ <code>expirationTime</code> ï¼Œæ–°ç‰ˆæœ¬ç”¨çš„æ˜¯ <code>lane</code>ï¼Œé‚£ä¹ˆå°±è¦ä¿è¯ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœæ›´æ–°å‘ç”Ÿåœ¨ä¸€ä¸ªå­ä»£èŠ‚ç‚¹ï¼Œé‚£ä¹ˆåªæœ‰çˆ¶èŠ‚ç‚¹ <code>beginWork</code> æ‰èƒ½è®©å­ä»£èŠ‚ç‚¹ <code>beginWork</code>ã€‚è¿™æ ·å°±å½¢æˆäº†ä¸€æ¡ root fiber -&gt; çˆ¶ fiber -&gt; å­ fiber çš„ <code>beginWork</code> é“¾ã€‚åœ¨ beginwork è¿‡ç¨‹ä¸­ï¼Œæœ‰å‡ ç§æƒ…å†µï¼š</p>
<ul>
<li>ç¬¬ä¸€ç§ï¼š å¦‚æœé‡åˆ°ç»„ä»¶ï¼Œè€Œä¸”æ›´æ–°ä¸æ¶‰åŠå½“å‰ç»„ä»¶ï¼Œä¹Ÿä¸åœ¨å½“å‰ç»„ä»¶çš„çˆ¶å­é€’å½’é“¾ä¸Šï¼Œé‚£ä¹ˆå°±ä¸ä¼š renderï¼Œä¹Ÿä¸ä¼šå‘ä¸‹ beginWork ã€‚</li>
<li>ç¬¬äºŒç§ï¼š å¦‚æœé‡åˆ°ç»„ä»¶ï¼Œè€Œä¸”æ›´æ–°ä¸æ¶‰åŠå½“å‰ç»„ä»¶ï¼Œä½†æ˜¯æ›´æ–°ç»„ä»¶å±äºå½“å‰ç»„ä»¶çš„å­å­™åä»£ï¼Œé‚£ä¹ˆä¸ä¼š renderï¼Œä½†æ˜¯ä¼šå‘ä¸‹ beginWork ï¼Œç›®çš„å¾ˆæ˜ç¡®ï¼Œæ‰¾åˆ°å¯¹åº”çš„æ›´æ–°ç»„ä»¶ã€‚</li>
<li>ç¬¬ä¸‰ç§ï¼š å¦‚æœé‡åˆ°å…¶ä»–ç±»å‹çš„ fiber æ¯”å¦‚ hostComponent  <code>&lt;div&gt;</code> ï¼Œé‚£ä¹ˆä¼šå¯¹æ¯”å½“å‰çš„æ›´æ–°ä¼˜å…ˆçº§ï¼Œå¦‚æœä½ä¼˜å…ˆçº§ï¼Œé‚£ä¹ˆä¸éœ€è¦å‘ä¸‹ beginWork ã€‚åä¹‹å‘ä¸‹ beginWorkã€‚</li>
</ul>
<p>è¿™ä¹ˆè¯´å¯èƒ½å¤§å®¶ä¸æ˜¯å¾ˆç†è§£ï¼Œæˆ‘ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p>
<p>å¦‚ä¸‹å½“ç‚¹å‡» componentB ä¸‹é¢çš„ span è§¦å‘ setState æ›´æ–° ï¼Œå¦‚ä¸‹å¯ä»¥æ¸…æ™°çœ‹è§ beginWork å’Œ render æµç¨‹ã€‚</p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261728013.jpeg" alt="context8.jpg"></p>
<ul>
<li>ä» root å¼€å§‹ç¬¬ä¸€æ¬¡è°ƒå’Œï¼Œ ä¸‰ä¸ª fiber éƒ½ä¼šç»å† beginWork ï¼Œé€šè¿‡å¯¹æ¯”ä¼˜å…ˆçº§ï¼Œ <code>componentA</code> å’Œ <code>div</code> åœæ­¢å‘ä¸‹ beginworkã€‚</li>
<li>æ›´æ–°å‘ç”Ÿåœ¨ componentB ï¼Œæ‰€ä»¥ componentB æ¸²æŸ“ï¼Œè§¦å‘ <code>render</code> ï¼Œå¾—åˆ°æ–°çš„ elementï¼Œé€šè¿‡å¯¹æ¯”ï¼Œ <code>div</code> <code>span</code> éƒ½ä¼š beginworkã€‚</li>
<li>componentC ç”±äºçˆ¶ç»„ä»¶æ›´æ–°ï¼Œæ²¡æœ‰ä»»ä½•ä¼˜åŒ–ç­–ç•¥çš„æƒ…å†µï¼Œé‚£ä¹ˆä¹Ÿä¼šè·Ÿç€ <code>render</code>ï¼Œæ¥ç€ div ä¹Ÿä¼šè·Ÿç€ beginworkã€‚</li>
</ul>
<p>é‚£ä¹ˆå¦‚ä¸Šï¼Œå¦‚æœ componentC é€šè¿‡ <code>PureComponent</code> æˆ–è€… <code>shouldComponentUpdate</code> é™åˆ¶æ›´æ–°ä¹‹åã€‚é‚£ä¹ˆä¼šå˜æˆå¦‚ä¸‹çš„æ ·å­ï¼š</p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261728058.jpeg" alt="context9.jpg"></p>
<ul>
<li>å¦‚ä¸Š componentC é€šè¿‡ <code>PureComponent</code> å¤„ç†åï¼Œä¸å† render ï¼Œå½“ç„¶ä¹Ÿä¸ä¼šå†å‘ä¸‹ beginworkã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œå¦‚æœç‚¹å‡» componentC ä¸‹çš„ divï¼Œè§¦å‘ setState æ›´æ–°ï¼Œé‚£ä¹ˆåˆä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p>
<ul>
<li>æ­¤æ—¶æ›´æ–°å‘ç”Ÿåœ¨ <code>componentC</code> ä¸Šï¼Œæ‰€ä»¥ componentB åªä¼šå‘ç”Ÿ beginwork ï¼Œä¸ä¼šå‘ç”Ÿ renderã€‚</li>
<li><code>componentB</code> ä¸‹é¢çš„ <code>div</code> ä¼šåœæ­¢å‘ä¸‹çš„ beiginwork ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261728664.jpeg" alt="context10.jpg"></p>
<p><strong>æˆ‘ä»¬æ€»ç»“æµç¨‹å¦‚ä¸‹ï¼š</strong></p>
<ul>
<li>1 å¦‚æœä¸€ä¸ªç»„ä»¶å‘ç”Ÿæ›´æ–°ï¼Œé‚£ä¹ˆå½“å‰ç»„ä»¶åˆ° fiber root ä¸Šçš„çˆ¶çº§é“¾ä¸Šçš„æ‰€æœ‰ fiber ï¼Œæ›´æ–°ä¼˜å…ˆçº§éƒ½ä¼šå‡é«˜ï¼Œéƒ½ä¼šè§¦å‘ beginwork ã€‚</li>
<li>2 render ä¸ç­‰äº beginWorkï¼Œä½†æ˜¯ render å‘ç”Ÿï¼Œä¸€å®šè§¦å‘äº† beginwork ã€‚</li>
<li>3 ä¸€æ¬¡ beginwork ï¼Œä¸€ä¸ª fiber ä¸‹çš„åŒçº§å…„å¼Ÿ fiber ä¼šå‘ç”Ÿå¯¹æ¯”ï¼Œæ‰¾åˆ°ä»»åŠ¡ä¼˜å…ˆçº§é«˜çš„ fiber ã€‚å‘ä¸‹ beginwork ã€‚</li>
</ul>
<p>å¯¹äº beginwork çš„æµç¨‹ï¼Œæ¥ä¸‹æ¥ä¼šæœ‰ä¸“é—¨çš„ç« èŠ‚ç»´æŠ¤ã€‚</p>
<p><strong>Context åŸç†</strong></p>
<p>æ¥ä¸‹æ¥è¨€å½’æ­£ä¼ ï¼Œæˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹ context çš„æ›´æ–°åŸç†ï¼Œä¸Šé¢è¯´åˆ° <code>Provider</code> æ›´æ–°ï¼Œä¼šé€’å½’æ‰€æœ‰çš„å­ç»„ä»¶ï¼Œåªè¦æ¶ˆè´¹äº† context çš„å­ä»£ fiber ï¼Œéƒ½ä¼šç»™ä¸€ä¸ªé«˜ä¼˜å…ˆçº§ã€‚è€Œä¸”å‘ä¸Šæ›´æ–°çˆ¶çº§ fiber é“¾ä¸Šçš„ä¼˜å…ˆçº§ï¼Œè®©æ‰€æœ‰çˆ¶çº§ fiber éƒ½å¤„äºä¸€ä¸ªé«˜ä¼˜å…ˆçº§ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥é«˜ä¼˜å…ˆçº§çš„ fiber éƒ½ä¼š beginWork ã€‚</p>
<p>é‚£ä¹ˆå°†ä¸Šè¿°ä¾‹å­è¿›è¡Œä¿®æ”¹ï¼Œ<code>propagateContextChange</code> çš„æµç¨‹ä¼šä¸‹å¦‚ä¸‹ä¸€æ ·ï¼ŒæŠŠçˆ¶çº§ fiber çš„ä¼˜å…ˆçº§æé«˜ã€‚</p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261728207.jpeg" alt="context11.jpg"></p>
<p>é‚£ä¹ˆæ•´ä¸ª fiber æ›´æ–°æµç¨‹ä¼šåƒå¦‚ä¸‹ä¸€æ ·</p>
<p><img src="https://raw.githubusercontent.com/Flashcard8009/image/main/img/202309261729525.jpeg" alt="context12.jpg"></p>
<h3 id="2-Consumer"><a href="#2-Consumer" class="headerlink" title="2 Consumer"></a>2 Consumer</h3><p>æˆ‘ä»¬å·²ç»è®²äº† Provider æ ¸å¿ƒåŸç†ï¼Œè¿˜æœ‰å¦å¤–ä¸€éƒ¨åˆ†å°±æ˜¯ Consumer ï¼Œç ”ç©¶ä¸€ä¸‹å…¶åŸç†ã€‚</p>
<h4 id="Consumer-æµç¨‹"><a href="#Consumer-æµç¨‹" class="headerlink" title="Consumer æµç¨‹"></a>Consumer æµç¨‹</h4><p>ä¸Šæ–‡è¯´é“ï¼ŒConsumer æœ¬è´¨ä¸Šæ˜¯ç±»å‹ä¸º <code>REACT_CONTEXT_TYPE</code> çš„ element å¯¹è±¡ã€‚åœ¨è°ƒå’Œé˜¶æ®µï¼Œä¼šè½¬åŒ–æˆ <code>ContextConsumer</code> ç±»å‹çš„ fiber å¯¹è±¡ã€‚åœ¨ beginwork ä¸­ï¼Œä¼šè°ƒç”¨ <code>updateContextConsumer</code> æ–¹æ³•ã€‚é‚£ä¹ˆè¿™ä¸ªæ–¹æ³•åšäº†äº›ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<blockquote>
<p>react&#x2F;react-reconcider&#x2F;src&#x2F;ReactFiberBeginWork.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">updateContextConsumer</span>(<span class="params">current,workInProgress,renderExpirationTime,</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> context  = workInProgress.<span class="property">type</span>;</span><br><span class="line">  <span class="keyword">const</span> newProps = workInProgress.<span class="property">pendingProps</span>;</span><br><span class="line">  <span class="comment">/* å¾—åˆ° render props children */</span></span><br><span class="line">  <span class="keyword">const</span> render = newProps.<span class="property">children</span>;</span><br><span class="line">  <span class="comment">/* è¯»å– context */</span> </span><br><span class="line">  <span class="title function_">prepareToReadContext</span>(workInProgress, renderExpirationTime);</span><br><span class="line">  <span class="comment">/* å¾—åˆ°æœ€æ–°çš„æ–°çš„ context value */</span></span><br><span class="line">  <span class="keyword">const</span> newValue = <span class="title function_">readContext</span>(context, newProps.<span class="property">unstable_observedBits</span>);</span><br><span class="line">  <span class="keyword">let</span> newChildren;</span><br><span class="line">  <span class="comment">/* å¾—åˆ°æœ€æ–°çš„ children element */</span></span><br><span class="line">  newChildren = <span class="title function_">render</span>(newValue);</span><br><span class="line">  workInProgress.<span class="property">effectTag</span> |= <span class="title class_">PerformedWork</span>;</span><br><span class="line">  <span class="comment">/* è°ƒå’Œ children */</span></span><br><span class="line">  <span class="title function_">reconcileChildren</span>(current, workInProgress, newChildren, renderExpirationTime);</span><br><span class="line">  <span class="keyword">return</span> workInProgress.<span class="property">child</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>updateContextConsumer</code>çš„æ ¸å¿ƒæµç¨‹ï¼š</p>
<ul>
<li>é¦–å…ˆè°ƒç”¨ <code>readContext</code> è·å–æœ€æ–°çš„ value ã€‚</li>
<li>ç„¶åé€šè¿‡ <code>render props</code> å‡½æ•°ï¼Œä¼ å…¥æœ€æ–°çš„ valueï¼Œå¾—åˆ°æœ€æ–°çš„ <code>children</code> ã€‚</li>
<li>æ¥ä¸‹æ¥è°ƒå’Œ children ã€‚</li>
</ul>
<p>é‚£ä¹ˆæœ‰ä¸€ä¸ªé—®é¢˜<strong>å°±æ˜¯ fiber ä¸Šçš„ dependencies å¦‚ä½•å’Œ context å»ºç«‹èµ·å…³è”ã€‚</strong> é‚£ä¹ˆå°±æ˜¯ <strong><code>readContext</code></strong> è¿™ä¸ªå‡½æ•°åšçš„äº‹ï¼Œå¯ä»¥æå‰é€éœ²ä¸€ä¸‹ï¼ŒuseContext å’Œ contextType æœ¬è´¨ä¸Šä¹Ÿæ˜¯</p>
<h4 id="readContext"><a href="#readContext" class="headerlink" title="readContext"></a>readContext</h4><p>readContext æ˜¯é™¤äº† <code>Provider</code> ä¹‹å¤–ï¼Œç¬¬äºŒä¸ªæ ¸å¿ƒçŸ¥è¯†ç‚¹ã€‚</p>
<blockquote>
<p>react&#x2F;react-reconcider&#x2F;src&#x2F;ReactFiberNewContext.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">readContext</span>(<span class="params"> context,observedBits </span>)&#123;</span><br><span class="line">    <span class="comment">/* åˆ›å»ºä¸€ä¸ª contextItem */</span></span><br><span class="line">    <span class="keyword">const</span> contextItem = &#123;</span><br><span class="line">      context,</span><br><span class="line">      <span class="attr">observedBits</span>: resolvedObservedBits,</span><br><span class="line">      <span class="attr">next</span>: <span class="literal">null</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">/* ä¸å­˜åœ¨æœ€åä¸€ä¸ª context Dependency  */</span></span><br><span class="line">    <span class="keyword">if</span> (lastContextDependency === <span class="literal">null</span>) &#123;</span><br><span class="line">      lastContextDependency = contextItem;</span><br><span class="line">      currentlyRenderingFiber.<span class="property">dependencies</span> = &#123;</span><br><span class="line">        <span class="attr">expirationTime</span>: <span class="title class_">NoWork</span>,</span><br><span class="line">        <span class="attr">firstContext</span>: contextItem,</span><br><span class="line">        <span class="attr">responders</span>: <span class="literal">null</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">/* å­˜åœ¨çš„æƒ…å†µ */</span></span><br><span class="line">      lastContextDependency = lastContextDependency.<span class="property">next</span> = contextItem;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">  <span class="keyword">return</span> isPrimaryRenderer ? context.<span class="property">_currentValue</span> : context.<span class="property">_currentValue2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>readContext ä¸»è¦åšçš„äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œé¦–å…ˆä¼šåˆ›å»ºä¸€ä¸ª contextItem ï¼Œä¸Šè¿°è¯´åˆ°è¿‡ fiber ä¸Šä¼šå­˜åœ¨å¤šä¸ª <code>dependencies</code> ï¼Œå®ƒä»¬ä»¥é“¾è¡¨çš„å½¢å¼è”ç³»åˆ°ä¸€èµ·ï¼Œå¦‚æœä¸å­˜åœ¨æœ€åä¸€ä¸ª <code>context dependency</code> ï¼Œé‚£è¯æ˜ context dependencies ä¸ºç©º ï¼Œé‚£ä¹ˆä¼šåˆ›å»ºç¬¬ä¸€ä¸ª dependency ï¼Œå¦‚æœå­˜åœ¨æœ€åä¸€ä¸ª dependency ï¼Œé‚£ä¹ˆ contextItem ä¼šä»¥é“¾è¡¨å½¢å¼ä¿å­˜ï¼Œå¹¶å˜æˆæœ€åä¸€ä¸ª lastContextDependency ã€‚</li>
</ul>
<h4 id="å¤šä¸ª-Provider-åµŒå¥—"><a href="#å¤šä¸ª-Provider-åµŒå¥—" class="headerlink" title="å¤šä¸ª Provider åµŒå¥—"></a>å¤šä¸ª Provider åµŒå¥—</h4><p>å¦‚æœæœ‰å¤šä¸ª Provider çš„æƒ…å†µï¼Œé‚£ä¹ˆåä¸€ä¸ª contextValue ä¼šè¦†ç›–å‰ä¸€ä¸ª contextValueï¼Œåœ¨å¼€å‘è€…è„‘æµ·ä¸­ï¼Œè¦æœ‰ä¸€ä¸ªå®šå¾‹å°±æ˜¯ï¼š**<code>Provider</code> æ˜¯ç”¨æ¥ä¼ é€’ valueï¼Œè€Œéä¿å­˜ value ã€‚** </p>
<h3 id="3-contextType-å’Œ-useContext"><a href="#3-contextType-å’Œ-useContext" class="headerlink" title="3 contextType å’Œ useContext"></a>3 contextType å’Œ useContext</h3><h4 id="useContext-åŸç†"><a href="#useContext-åŸç†" class="headerlink" title="useContext åŸç†"></a>useContext åŸç†</h4><p><code>useContext</code> åŸç†ï¼Œè°ƒç”¨ useContext æœ¬è´¨ä¸Šè°ƒç”¨ <code>readContext</code> æ–¹æ³•ã€‚</p>
<blockquote>
<p>react&#x2F;react-reconcider&#x2F;src&#x2F;ReactFiberHooks.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">HooksDispatcherOnMount</span> =&#123;</span><br><span class="line">    <span class="attr">useContext</span>: readContext</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>å‡½æ•°ç»„ä»¶é€šè¿‡ readContext ï¼Œå°†å‡½æ•°ç»„ä»¶çš„ <code>dependencies</code>å’Œå½“å‰ context å»ºç«‹èµ·å…³è”ï¼Œcontext æ”¹å˜ï¼Œå°†å½“å‰å‡½æ•°ç»„ä»¶è®¾ç½®é«˜ä¼˜å…ˆçº§ï¼Œä¿ƒä½¿å…¶æ¸²æŸ“ã€‚</li>
</ul>
<h4 id="contextType-åŸç†"><a href="#contextType-åŸç†" class="headerlink" title="contextType åŸç†"></a>contextType åŸç†</h4><p>ç±»ç»„ä»¶çš„é™æ€å±æ€§ <code>contextType</code> å’Œ useContext ä¸€æ ·ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯è°ƒç”¨ readContext æ–¹æ³•ã€‚</p>
<blockquote>
<p>react&#x2F;react-reconcider&#x2F;src&#x2F;ReactFiberClassComponent.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">constructClassInstance</span>(<span class="params">workInProgress,ctor,props</span>)&#123;</span><br><span class="line">     <span class="keyword">if</span> (<span class="keyword">typeof</span> contextType === <span class="string">&#x27;object&#x27;</span> &amp;&amp; contextType !== <span class="literal">null</span>) &#123;</span><br><span class="line">         <span class="comment">/* è¯»å– context  */</span></span><br><span class="line">        context = <span class="title function_">readContext</span>(contextType);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> instance = <span class="keyword">new</span> <span class="title function_">ctor</span>(props, context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>é™æ€å±æ€§ contextType ï¼Œåœ¨ç±»ç»„ä»¶å®ä¾‹åŒ–çš„æ—¶å€™è¢«ä½¿ç”¨ï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯è°ƒç”¨ <code>readContext</code>å°† context å’Œ fiber ä¸Šçš„  <code>dependencies</code> å»ºç«‹èµ·å…³è”ã€‚</li>
</ul>
<h3 id="4-Context-æµç¨‹æ€»ç»“"><a href="#4-Context-æµç¨‹æ€»ç»“" class="headerlink" title="4 Context æµç¨‹æ€»ç»“"></a>4 Context æµç¨‹æ€»ç»“</h3><p>ä¸‹é¢å¯¹æ•´ä¸ª context åŸç†éƒ¨åˆ†åšæ€»ç»“ã€‚</p>
<ul>
<li><p>Provider ä¼ é€’æµç¨‹ï¼šProvider çš„æ›´æ–°ï¼Œä¼šæ·±åº¦éå†å­ä»£ fiberï¼Œæ¶ˆè´¹ context çš„ fiber å’Œçˆ¶çº§é“¾éƒ½ä¼šæå‡æ›´æ–°ä¼˜å…ˆçº§ã€‚ å¯¹äºç±»ç»„ä»¶çš„ fiber ï¼Œä¼š forceUpdate å¤„ç†ã€‚æ¥ä¸‹æ¥æ‰€æœ‰æ¶ˆè´¹çš„ fiberï¼Œéƒ½ä¼š beginWork ã€‚</p>
</li>
<li><p>context è®¢é˜…æµç¨‹ï¼š <code>contextType</code> ï¼Œ <code>useContext</code>ï¼Œ <code>Consumer</code> ä¼šå†…éƒ¨è°ƒç”¨ <code>readContext</code> ï¼ŒreadContext ä¼šæŠŠ fiber ä¸Šçš„ <code>dependencies</code> å±æ€§å’Œ context å¯¹è±¡å»ºç«‹èµ·å…³è”ã€‚</p>
</li>
</ul>
<h3 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5 æ€»ç»“"></a>5 æ€»ç»“</h3><p>æœ¬ç« èŠ‚çŸ¥è¯†ç‚¹æ€»ç»“:</p>
<ul>
<li>context åŸç†ï¼ŒProvider åšäº†äº›ä»€ä¹ˆã€‚</li>
<li>beginWork å’Œ render çš„æ›´æ–°åŸåˆ™å’ŒåŒºåˆ«ã€‚</li>
<li>ä¸‰ç§ context ä¼ é€’æ¨¡å¼åŸç†ã€‚</li>
<li>context è®¢é˜…æ¶ˆè´¹åŸç†ã€‚</li>
<li>Provider åµŒå¥—ä¼ é€’åŸç†ã€‚</li>
</ul>
<p>é€æ¼ä¸€ä¸‹ï¼Œæ¥ä¸‹æ¥ä¼šæ›´æ–°å¦å¤–ä¸€ä¸ªæ–°çš„ç« èŠ‚ fiber åˆå§‹åŒ–å’Œè°ƒå’Œæµç¨‹ã€‚</p>
</div><div class="tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/book/tags/React/" rel="tag">React</a></li></ul></div><div class="post-nav"><a class="pre" href="/book/2023/chapter-30-practical-chapter-customized-hooks-practice/">ç¬¬30ç« â€”å®è·µç¯‡-è‡ªå®šä¹‰Hookså®è·µ</a><a class="next" href="/book/2023/chapter-32-principles-the-whole-process-of-grinwork-and-render/">ç¬¬32ç« â€”åŸç†ç¯‡-beginWorkå’Œrenderå…¨æµç¨‹</a></div><script src="https://utteranc.es/client.js" repo="Flashcard8009/book" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="å…³äº"><img class="nofancybox" src="https://avatars.githubusercontent.com/Flashcard8009"/></a><p>To be a better man.</p><a class="info-icon" href="https://github.com/Flashcard8009" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/username" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/book/categories/%E9%BB%98%E8%AE%A4/">é»˜è®¤</a><span class="category-list-count">42</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/book/tags/React/" style="font-size: 15px;">React</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-04-basic-chapter-metaphysics-state/">ç¬¬04ç« â€”åŸºç¡€ç¯‡-ç„å­¦state</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-05-basic-chapter-deep-tips/">ç¬¬05ç« â€”åŸºç¡€ç¯‡-æ·±å…¥props</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-06-basic-chapter-understanding-lifecycle/">ç¬¬06ç« â€”åŸºç¡€ç¯‡-ç†è§£lifeCycle</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-07-basic-chapter-multifunctional-ref/">ç¬¬07ç« â€”åŸºç¡€ç¯‡-å¤šåŠŸèƒ½Ref</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-08-basic-chapter-provider-context/">ç¬¬08ç« â€”åŸºç¡€ç¯‡-æä¾›è€…context</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-09-fundamentals-modular-css/">ç¬¬09ç« â€”åŸºç¡€ç¯‡-æ¨¡å—åŒ–css</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-10-fundamentals-advanced-components/">ç¬¬10ç« â€”åŸºç¡€ç¯‡-é«˜é˜¶ç»„ä»¶</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-11-optimization-rendering-control/">ç¬¬11ç« â€”ä¼˜åŒ–ç¯‡-æ¸²æŸ“æ§åˆ¶</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-12-optimization-chapter-rendering-tuning/">ç¬¬12ç« â€”ä¼˜åŒ–ç¯‡-æ¸²æŸ“è°ƒä¼˜</a></li><li class="post-list-item"><a class="post-list-link" href="/book/2023/chapter-13-optimization-processing-massive-data/">ç¬¬13ç« â€”ä¼˜åŒ–ç¯‡-å¤„ç†æµ·é‡æ•°æ®</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="/" title="ä¸­æ–‡åšå®¢" target="_blank">ä¸­æ–‡åšå®¢</a><ul></ul><a href="/en" title="EN Blog" target="_blank">EN Blog</a><ul></ul><a href="https://github.com/Flashcard8009" title="GitHub" target="_blank">GitHub</a><ul></ul><a href="https://www.baidu.com/" title="ç™¾åº¦" target="_blank">ç™¾åº¦</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2023 <a href="/book/." rel="nofollow">æ˜é‡‘å°å†Œ.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/book/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/book/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/book/css/search.css?v=1.0.0"><script type="text/javascript" src="/book/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/book/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/book/js/copycode.js?v=1.0.0" successtext="å¤åˆ¶æˆåŠŸï¼"></script><link rel="stylesheet" type="text/css" href="/book/css/copycode.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="/book/css/external.css?v=1.0.0"><script type="text/javascript" src="/book/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/book/js/smartresize.js?v=1.0.0"></script></div></body></html>